<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>Under the hood of BOLT-LMM</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GWAS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Journal clubs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="boltLmm.html">1. BOLT-LMM</a>
    </li>
    <li>
      <a href="regenie.html">2. REGENIE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="https://github.com/statOmics/gwasVaudelApril2024">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Under the hood of BOLT-LMM</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<ul>
<li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4342297/pdf/nihms650284.pdf">BOLT-LMM paper</a></li>
<li><a href="https://static-content.springer.com/esm/art%3A10.1038%2Fng.3190/MediaObjects/41588_2015_BFng3190_MOESM5_ESM.pdf">Supplementary Information</a></li>
</ul>
<div id="linear-mixed-model-for-gwas" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Linear mixed model for GWAS</h1>
<div id="specification" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Specification</h2>
<p><span class="math display">\[
\tag{1}
\mathbf{Y} = \mathbf{x}_\text{test}\beta_\text{test} + \mathbf{X}_c\boldsymbol{\beta}_c + \mathbf{Z}_{GRM}\mathbf{u} +\boldsymbol{\epsilon}
\]</span>
with</p>
<ul>
<li><span class="math inline">\(\mathbf{Y}\)</span> an <span class="math inline">\(N\times1\)</span> vector of the phenotype</li>
<li><span class="math inline">\(\mathbf{x}_\text{test}\)</span> an <span class="math inline">\(N\times1\)</span> vector with the genotype for the candidate SNP</li>
<li><span class="math inline">\(\beta_\text{test}\)</span> the association of candidate SNP and the phenotype</li>
<li><span class="math inline">\(\mathbf{X}_c\)</span> an <span class="math inline">\(N\times p\)</span> matrix with the covariate pattern for <span class="math inline">\(C\)</span> known covariates (vector of ones (intercept), age, gender, batch,…)</li>
<li><span class="math inline">\(\boldsymbol{\beta}_c\)</span> the <span class="math inline">\(p\times 1\)</span> vector of parameters modeling the association of the p covariates and the phenotype.</li>
<li><span class="math inline">\(\mathbf{Z}\)</span> an <span class="math inline">\(N\times M\)</span> genetic relationship matrix (GRM) with all normalised genotypes</li>
<li><span class="math inline">\(\mathbf{u}\)</span> an <span class="math inline">\(M\times 1\)</span> vector with i.i.d. random effect for each SNP <span class="math inline">\(\mathbf{u}\sim \text{MVN}(0,\mathbf{I}\sigma_u^2)\)</span></li>
<li><span class="math inline">\(\boldsymbol{\epsilon}\)</span> an <span class="math inline">\(N\times 1\)</span> vector with environmental residuals that are assumed to be independent of <span class="math inline">\(\mathbf{u}\)</span> and i.i.d. <span class="math inline">\(\boldsymbol{\epsilon}\sim \text{MVN}(0,\mathbf{I}\sigma_\epsilon^2)\)</span></li>
</ul>
<p>Random effects are used to model the correlation structure in the data. They imply a certain covariance structure of <span class="math inline">\(\mathbf{y}\)</span></p>
</div>
<div id="covariance-structure" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Covariance structure</h2>
<p>Covariance structure of <span class="math inline">\(\mathbf{y}\)</span> implied by GWAS mixed model:</p>
<p><span class="math display">\[
\begin{array}{ccl}
\text{var}\left[\mathbf{Y}\right] &amp;=&amp; \text{var}\left[\mathbf{x}_\text{test}\beta_\text{test} + \mathbf{X}_c\boldsymbol{\beta}_c + \mathbf{Z}_\text{GRM}\mathbf{u} +\boldsymbol{\epsilon}\right]\\\\
&amp;\updownarrow&amp; \mathbf{u} \perp \boldsymbol{\epsilon}\\\\
&amp;=&amp; \text{var}[\mathbf{Z}_\text{GRM}\mathbf{u}] + \text{var}[\boldsymbol{\epsilon}]\\\\
&amp;=&amp;\mathbf{Z}_\text{GRM}\text{var}[\mathbf{u}]\mathbf{Z}_\text{GRM}^T + \mathbf{I} \sigma^2\\\\
&amp;=&amp;\mathbf{Z}_\text{GRM}\mathbf{I}\sigma^2_u\mathbf{Z}_\text{GRM}^T + \mathbf{I} \sigma^2_\epsilon \\\\
&amp;=&amp;\mathbf{Z}_\text{GRM}\mathbf{Z}_\text{GRM}^T \sigma^2_u+ \mathbf{I} \sigma^2_\epsilon
\end{array}
\]</span></p>
<p>Note that the model is often also written in another way:</p>
<p><span class="math display">\[
\tag{1}
\mathbf{Y} = \mathbf{x}_\text{test}\beta_\text{test} + \mathbf{X}_c\boldsymbol{\beta}_c + \mathbf{g} +\boldsymbol{\epsilon}
\]</span></p>
<ul>
<li><p>with <span class="math inline">\(\mathbf{g} \sim \text{MVN}(\mathbf{0},\mathbf{K}\sigma^2_g)\)</span></p></li>
<li><p><span class="math inline">\(\mathbf{K}\)</span> the <span class="math inline">\(N \times N\)</span> empirical kinship matrix</p></li>
</ul>
<p><span class="math display">\[
\mathbf{K} = \frac{\mathbf{Z}_\text{GRM}\mathbf{Z}^T_\text{GRM}}{M}
\]</span></p>
<ul>
<li><span class="math inline">\(\sigma_g^2\)</span> the polygenic variance <span class="math inline">\(\sigma_g^2=M\sigma_u^2\)</span></li>
</ul>
</div>
<div id="main-advantages-of-lmm-method" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Main advantages of LMM method</h2>
<ol style="list-style-type: decimal">
<li>Prevention of false positive associations due to population or relatedness structure</li>
<li>An increase in power obtained through the application of a correction that is specific to this structure.</li>
<li>LMM can also increase power by implicitly conditioning on associated loci other than the candidate locus.</li>
</ol>
</div>
<div id="pitfalls-of-lmm" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Pitfalls of LMM</h2>
<ol style="list-style-type: decimal">
<li>Computational complexity:</li>
</ol>
<ul>
<li><span class="math inline">\(M &gt; 500.000\)</span>, <span class="math inline">\(N &gt; 70000\)</span></li>
<li>Building the GRM (<span class="math inline">\(M \times M\)</span> matrix)</li>
<li>Estimating the mean and variance components for each of the <span class="math inline">\(M\)</span> candidate SNP!</li>
<li>Association statistics for each variant (for each SNP!)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Loss in power when the candidate marker is included in the GRM</p></li>
<li><p>Using a small subset of markers in the GRM can compromise correction for stratification</p></li>
</ol>
</div>
</div>
<div id="bolt-lmm" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Bolt LMM</h1>
<p>What does projecting out covariates <span class="math inline">\(\mathbf{X}_c\)</span> mean?</p>
<div id="intermezzo-projections" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Intermezzo Projections</h2>
<p>Linear regression and least squares are projections.</p>
<div id="toy-data" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Toy-Data</h3>
<p>Consider the following toy-dataset with 3 observation (X,Y):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">y=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>data</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["int"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1"},{"1":"2","2":"2"},{"1":"3","2":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="scalar-model-form" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Scalar model form</h3>
<ul>
<li>Consider a vector of predictors <span class="math inline">\(\mathbf{x}=(x_1,\ldots,x_p)\)</span> and</li>
<li>a real-valued response <span class="math inline">\(Y\)</span></li>
<li>then the linear regression model can be written as
<span class="math display">\[
y_i=\beta_0+\sum\limits_{j=1}^p x_{ij}\beta_j + \epsilon
\]</span></li>
</ul>
<p>Scalar model for the toy dataset</p>
<p><span class="math display">\[
y_i=\beta_0+\beta_1x + \epsilon_i
\]</span></p>
<p>If we write the model for each observation:</p>
<p><span class="math display">\[
\begin{array} {lcl}
1 &amp;=&amp; \beta_0+\beta_1 1  + \epsilon_1 \\
2 &amp;=&amp; \beta_0 + \beta_1 2 + \epsilon_2 \\
2 &amp;=&amp; \beta_0+\beta_1 3+ \epsilon_3 \\
\end{array}
\]</span></p>
</div>
<div id="vectormatrix-form" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Vector/Matrix form</h3>
<ul>
<li><span class="math inline">\(n\)</span> observations <span class="math inline">\((\mathbf{x}_1,y_1) \ldots (\mathbf{x}_n,y_n)\)</span> with <span class="math inline">\(\mathbf{x}_1^T=[\begin{array}{cccc} 1&amp; x_1&amp; \ldots&amp; x_p\end{array}]\)</span></li>
<li>Regression in matrix notation
<span class="math display">\[\mathbf{Y}=\mathbf{X\beta} + \mathbf{\epsilon}\]</span>
with <span class="math inline">\(\mathbf{Y}=\left[\begin{array}{c}y_1\\ \vdots\\y_n\end{array}\right]\)</span>,
<span class="math inline">\(\mathbf{X}=\left[\begin{array}{cccc} 1&amp;x_{11}&amp;\ldots&amp;x_{1p}\\ \vdots&amp;\vdots&amp;&amp;\vdots\\ 1&amp;x_{n1}&amp;\ldots&amp;x_{np} \end{array}\right]\)</span> or <span class="math inline">\(\mathbf{X}=\left[\begin{array}{c} \mathbf{x}_1^T\\\vdots\\\mathbf{x}_n^T\end{array}\right]\)</span>,
<span class="math inline">\(\boldsymbol{\beta}=\left[\begin{array}{c}\beta_0\\ \vdots\\ \beta_p\end{array}\right]\)</span> and
<span class="math inline">\(\mathbf{\epsilon}=\left[\begin{array}{c} \epsilon_1 \\ \vdots \\ \epsilon_n\end{array}\right]\)</span></li>
</ul>
<p>Application to toy dataset:</p>
<p><span class="math display">\[
\mathbf{Y} = \mathbf{X}\boldsymbol{\beta}+\boldsymbol{\epsilon}
\]</span></p>
<p>with</p>
<p><span class="math display">\[
\mathbf{Y}=\left[
\begin{array}{c}
1\\
2\\
2\\
\end{array}\right],
\quad
\mathbf{X}= \left[
\begin{array}{cc}
1&amp;1\\
1&amp;2\\
1&amp;3\\
\end{array}
\right],
\quad \boldsymbol{\beta} = \left[
\begin{array}{c}
\beta_0\\
\beta_1\\
\end{array}
\right]
\quad
\text{and}
\quad
\boldsymbol{\epsilon}=
\left[
\begin{array}{c}
\epsilon_1\\
\epsilon_2\\
\epsilon_3
\end{array}
\right]
\]</span></p>
</div>
<div id="interpretation" class="section level3" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Interpretation</h3>
<p>From the linear regression we get
<span class="math display">\[
  E[Y \mid \mathbf{x}] = \mathbf{x}^T\boldsymbol{\beta} .
\]</span></p>
<ul>
<li>Hence, the <span class="math inline">\(\beta\)</span> parameters relate the predictor <span class="math inline">\(\mathbf{x}\)</span> to the mean outcome.</li>
<li>If we know the covariate pattern <span class="math inline">\(\mathbf{x}\)</span> we can use the model to
predict <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>For a model with a single predictor, e.g. Y is BMI and <span class="math inline">\(x_1\)</span> is bloodpressure (BP) we obtain</p>
<p><span class="math display">\[
E[Y \mid x_1] = \beta_0 + \beta_1 x_1
\]</span>
and
<span class="math display">\[
\begin{array}{rccl}
\beta_1 &amp;=&amp; E[Y\mid x_1=b+1] &amp;- E[Y\mid x_1=b] \\
&amp;=&amp; \beta_0 + \beta_1 (b+1)&amp; - \beta_0 - \beta_1 b
\end{array}
\]</span></p>
<ul>
<li><p>The parameter <span class="math inline">\(\beta_1\)</span> has an interpretation as the average difference in BMI between subjects that differ with 1mmHG in BP.</p></li>
<li><p>The parameter <span class="math inline">\(\beta_1\)</span> does not say much about individual outcomes. The residual variance <span class="math inline">\(\sigma^2\)</span> determines how much individual outcomes vary about the mean outcome.</p></li>
</ul>
<p>For a model with multiple predictors: BP (<span class="math inline">\(x_1\)</span>), sex (<span class="math inline">\(x_2\)</span>), age (<span class="math inline">\(x_3\)</span>) we obtain</p>
<p><span class="math display">\[
E[Y \mid x_1, x_2, x_3] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3
\]</span>
and
<span class="math display">\[
\begin{array}{rcl}
\beta_1 &amp;=&amp; E[Y\mid x_1=b+1, x_2=s, x_3 = a] - E[Y\mid x_1=b, x_2=s, x_3 = a]\\\\
&amp;=&amp; \beta_0 + \beta_1 (b+1) + \beta_3 s + \beta_3 a  - \beta_0 - \beta_1 b - \beta_3 s - \beta_3 a.
\end{array}
\]</span></p>
<ul>
<li>The parameter <span class="math inline">\(\beta_1\)</span> has an interpretation as the average difference in BMI between subjects of the same sex and the same age that differ 1 mmHg in BP.</li>
<li>or average difference in BMI between subjects that differ 1 mmHg in BP while controlling for age and gender.</li>
</ul>
<p>The <span class="math inline">\(\boldsymbol{\beta}\)</span> parameters are used to measure association, but a <span class="math inline">\(\boldsymbol{\beta} \neq \mathbf{0}\)</span> does not necessarily mean that the model will give good predictions.</p>
<p><span class="math display">\[
\hat Y = \mathbf{x}^T \hat \beta
\]</span>
Model fit and predictions based on the toy dataset</p>
<p><img src="boltLmm_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="estimation-of-boldsymbolbeta" class="section level3" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Estimation of <span class="math inline">\(\boldsymbol{\beta}\)</span></h3>
<div id="ordinary-least-squares-ols" class="section level4" number="2.1.5.1">
<h4><span class="header-section-number">2.1.5.1</span> Ordinary Least Squares (OLS)</h4>
<ul>
<li><p>Minimize the sum of squares of the errors
<span class="math display">\[\begin{eqnarray*}
\text{SSE}(\boldsymbol{\beta})&amp;=&amp;\sum\limits_{i=1}^n e^2_i\\\\
&amp;=&amp;\sum\limits_{i=1}^n \left(y_i-\beta_0-\sum\limits_{j=1}^p x_{ij}\beta_j\right)^2
\end{eqnarray*}\]</span></p></li>
<li><p>or in matrix notation
<span class="math display">\[\begin{eqnarray*}
\text{SSE}(\boldsymbol{\beta})&amp;=&amp;\mathbf{e}^T\mathbf{e}\\\\
&amp;=&amp; \left[\begin{array}{ccc} e_1 &amp;\ldots&amp; e_n \end{array}\right]\left[\begin{array}{c}e_1\\\vdots\\e_n\end{array}\right]\\
&amp;=&amp; e_1^2 + e_2^2 + \ldots + e_n^2\\\\
&amp;=&amp;(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X\beta})\\\\
&amp;=&amp;\Vert \mathbf{Y}-\mathbf{X\beta}\Vert^2_2\\
\end{eqnarray*}\]</span>
with the <span class="math inline">\(L_2\)</span>-norm of a <span class="math inline">\(p\)</span>-dim. vector <span class="math inline">\(v\)</span> <span class="math inline">\(\Vert \mathbf{v} \Vert_2=\sqrt{v_1^2+\ldots+v_p^2}\)</span><br />
<span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(\hat{\boldsymbol{\beta}}=\text{argmin}_\beta \Vert \mathbf{Y}-\mathbf{X\beta}\Vert^2_2\)</span></p></li>
</ul>
<hr />
</div>
<div id="minimize-sse" class="section level4" number="2.1.5.2">
<h4><span class="header-section-number">2.1.5.2</span> Minimize SSE</h4>
<p><span class="math display">\[
\begin{array}{ccc}
\frac{\partial}{\partial \boldsymbol{\beta}} \text{SSE}&amp;=&amp;\mathbf{0}\\\\
\frac{\partial}{\partial \boldsymbol{\beta}}(\mathbf{Y}-\mathbf{X\beta})^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})&amp;=&amp;\mathbf{0}\\\\
-2\mathbf{X}^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})&amp;=&amp;\mathbf{0}\\\\
-2\mathbf{X}^T\mathbf{Y} + 2\mathbf{X}^T\mathbf{X\beta}&amp;=&amp;0\\\\
\mathbf{X}^T\mathbf{X\beta}&amp;=&amp;\mathbf{X}^T\mathbf{Y}\\\\
\hat{\boldsymbol{\beta}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}
\end{array}
\]</span></p>
<p>It can be shown that the estimator is unbiased:</p>
<p><span class="math display">\[
\begin{array}{ccc}
E[\hat{\boldsymbol{\beta}}]&amp;=&amp;E[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}]\\ \\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T E[\mathbf{Y}]\\\\
&amp;=&amp; (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}\boldsymbol{\beta}\\\\
&amp;=&amp; \boldsymbol{\beta}
\end{array}
\]</span></p>
<hr />
</div>
</div>
<div id="projection" class="section level3" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Projection</h3>
<p>There is also another picture to regression:</p>
<ul>
<li><p>Instead of plotting each observation <span class="math inline">\(i= 1 \ldots n\)</span> as a data-point in <span class="math inline">\(\mathbb{R}^p\)</span> with dimensions <span class="math inline">\(1 \ldots p\)</span> for every variable/feature that is recorded for each observation</p></li>
<li><p>We can also plot <span class="math inline">\(\mathbf{Y}\)</span>, <span class="math inline">\(\hat{\mathbf{Y}}\)</span> and each column of <span class="math inline">\(\mathbf{X}\)</span>: <span class="math inline">\(\mathbf{X}_j\)</span> with <span class="math inline">\(j=1 \ldots p\)</span> as a vector in <span class="math inline">\(\mathbb{R}^n\)</span> with dimensions <span class="math inline">\(1 \ldots n\)</span> for every observation.</p></li>
<li><p>In this representation linear regression can be interpreted as a projection of the vector <span class="math inline">\(\mathbf{Y}\)</span> onto the subspace of <span class="math inline">\(\mathbb{R}^n\)</span> that is spanned by the vectors for the predictors <span class="math inline">\(\mathbf{X}_1 \ldots \mathbf{X}_p\)</span>.</p></li>
<li><p>The space <span class="math inline">\(\mathbf{X}_1 \ldots \mathbf{X}_p\)</span> is also referred to as the column space of <span class="math inline">\(\mathbf{X}\)</span>, the space that consists of all linear combinations of the vectors of the predictors or columns <span class="math inline">\(\mathbf{X}_1 \ldots \mathbf{X}_p\)</span>.</p></li>
</ul>
<div id="intermezzo-projection-of-vector-on-x-and-y-axis" class="section level4" number="2.1.6.1">
<h4><span class="header-section-number">2.1.6.1</span> Intermezzo: Projection of vector on X and Y axis</h4>
<p><span class="math display">\[
\mathbf{e}=\left[\begin{array}{c} e_1\\e_2\end{array}\right], \mathbf{u}_1 =  \left[\begin{array}{c} 1\\0\end{array}\right], \mathbf{u}_2 =  \left[\begin{array}{c} 0\\1\end{array}\right]
\]</span></p>
<p><img src="boltLmm_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>Projection of vector e on x-axis</li>
</ol>
<p><span class="math display">\[\begin{eqnarray*}
\mathbf{u}_1^T \mathbf{e} &amp;=&amp; \Vert \mathbf{u}_1\Vert_2  \Vert \mathbf{e}_1\Vert_2 \cos &lt;\mathbf{u}_1,\mathbf{e}_1&gt;\\
&amp;=&amp;\left[\begin{array}{cc} 1&amp;0\end{array}\right] \left[\begin{array}{c} e_1\\e_2\end{array}\right]\\ &amp;=&amp; 1\times e_1 + 0 \times e_2 \\
&amp;=&amp; e_1\\
\end{eqnarray*}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Projection of vector e on y-axis</li>
</ol>
<p><span class="math display">\[\begin{eqnarray*}
\mathbf{u}_2^T \mathbf{e} &amp;=&amp; \left[\begin{array}{cc} 0&amp;1\end{array}\right] \left[\begin{array}{c} e_1\\e_2\end{array}\right]\\ &amp;=&amp; 0\times e_1 + 1 \times e_2 \\
&amp;=&amp; e_2
\end{eqnarray*}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Projection of vector e on itself</li>
</ol>
<p><span class="math display">\[\begin{eqnarray*}
\mathbf{e}^T \mathbf{e} &amp;=&amp;\left[\begin{array}{cc} e_1&amp;e_2\end{array}\right] \left[\begin{array}{c} e_1\\e_2\end{array}\right]\\
&amp;=&amp;e_1^2+e_2^2\\
&amp;=&amp;\Vert e \Vert^2_2 \rightarrow \text{ Pythagorean theorem}
\end{eqnarray*}\]</span></p>
<hr />
</div>
<div id="interpretation-of-least-squares-as-a-projection" class="section level4" number="2.1.6.2">
<h4><span class="header-section-number">2.1.6.2</span> Interpretation of least squares as a projection</h4>
<p>Fitted values:</p>
<p><span class="math display">\[
\begin{array}{lcl}
\hat{\mathbf{Y}} &amp;=&amp; \mathbf{X}\hat{\boldsymbol{\beta}}\\
&amp;=&amp; \mathbf{X} (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}\\
&amp;=&amp; \mathbf{HY}
\end{array}
\]</span>
with <span class="math inline">\(\mathbf{H}\)</span> the projection matrix also referred to as the hat matrix.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>x,data)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##   (Intercept) x
## 1           1 1
## 2           1 2
## 3           1 3
## attr(,&quot;assign&quot;)
## [1] 0 1</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>XtX</span></code></pre></div>
<pre><code>##             (Intercept)  x
## (Intercept)           3  6
## x                     6 14</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>XtXinv <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>XtXinv</span></code></pre></div>
<pre><code>##             (Intercept)    x
## (Intercept)    2.333333 -1.0
## x             -1.000000  0.5</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>H <span class="ot">&lt;-</span> X <span class="sc">%*%</span> XtXinv <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>H</span></code></pre></div>
<pre><code>##            1         2          3
## 1  0.8333333 0.3333333 -0.1666667
## 2  0.3333333 0.3333333  0.3333333
## 3 -0.1666667 0.3333333  0.8333333</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>Yhat <span class="ot">&lt;-</span> H<span class="sc">%*%</span>Y</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>Yhat</span></code></pre></div>
<pre><code>##       [,1]
## 1 1.166667
## 2 1.666667
## 3 2.166667</code></pre>
<ul>
<li><p>We can also interpret the fit as the projection of the <span class="math inline">\(n\times 1\)</span> vector <span class="math inline">\(\mathbf{Y}\)</span> on the column space of the matrix <span class="math inline">\(\mathbf{X}\)</span>.</p></li>
<li><p>So each column in <span class="math inline">\(\mathbf{X}\)</span> is also an <span class="math inline">\(n\times 1\)</span> vector.</p></li>
<li><p>For the toy example n=3 and p=2.
The other picture to linear regression is to consider <span class="math inline">\(X_0\)</span>, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y\)</span> as vectors in the space of the data <span class="math inline">\(\mathbb{R}^n\)</span>, here <span class="math inline">\(\mathbb{R}^3\)</span> because we have three data points.
So the column space of X is a plane in the three dimensional space.</p></li>
</ul>
<p><span class="math display">\[
\hat{\mathbf{Y}} = \mathbf{X} (\mathbf{X}^T\mathbf{X})^{-1} \mathbf{X}^T \mathbf{Y}
\]</span></p>
<ol style="list-style-type: decimal">
<li>Plane spanned by column space:
The other picture to linear regression is to consider <span class="math inline">\(X_0\)</span>, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y\)</span> as vectors in the space of the data <span class="math inline">\(\mathbb{R}^n\)</span>, here <span class="math inline">\(\mathbb{R}^3\)</span> because we have three data points.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>originRn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1=</span><span class="dv">0</span>,<span class="at">X2=</span><span class="dv">0</span>,<span class="at">X3=</span><span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>data<span class="sc">$</span>x0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>dataRn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(data))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    originRn,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span> X1,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span> X2,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    <span class="at">z=</span> <span class="sc">~</span> X3, <span class="at">name=</span><span class="st">&quot;origin&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>      <span class="at">aspectmode=</span><span class="st">&quot;cube&quot;</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)), <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)), <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>      )</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>    )</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;obs1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;obs2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;obs3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;X1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;X2&quot;</span>)</span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a>p1</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-72582f7e986402a55bf7" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-72582f7e986402a55bf7">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ol start="2" style="list-style-type: decimal">
<li>Vector of Y:</li>
</ol>
<p>Actual values of <span class="math inline">\(\mathbf{Y}\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>data<span class="sc">$</span>y</span></code></pre></div>
<pre><code>## [1] 1 2 2</code></pre>
<p><span class="math display">\[
\mathbf{Y}=\left[\begin{array}{c}
1 \\
2 \\
2
\end{array}\right]
\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">1</span>]),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">2</span>]),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">3</span>]),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>p2</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-84fbaed40d18624643ac" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-84fbaed40d18624643ac">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","mode":"lines","line":{"color":"red","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ol start="3" style="list-style-type: decimal">
<li>Projection of Y onto column space</li>
</ol>
<p>Actual values of fitted values <span class="math inline">\(\mathbf{\hat{Y}}\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>data<span class="sc">$</span>yhat</span></code></pre></div>
<pre><code>## [1] 1.166667 1.666667 2.166667</code></pre>
<p><span class="math display">\[
\mathbf{Y}=\left[\begin{array}{c}
1.1666667 \\
1.6666667 \\
2.1666667
\end{array}\right]
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p2 <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">1</span>]),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">2</span>]),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">3</span>]),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Yhat&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(Y[<span class="dv">1</span>],Yhat[<span class="dv">1</span>]),</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(Y[<span class="dv">2</span>],Yhat[<span class="dv">2</span>]),</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(Y[<span class="dv">3</span>],Yhat[<span class="dv">3</span>]),</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Y -&gt; Yhat&quot;</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>    )</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>p2</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-33a6c6c3cb935e72a051" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-33a6c6c3cb935e72a051">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,1.1666666666666674],"y":[0,1.6666666666666674],"z":[0,2.1666666666666674],"name":"Yhat","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"orange"},"type":"scatter3d","inherit":true},"1ae127f1119.8":{"x":[1,1.1666666666666674],"y":[2,1.6666666666666674],"z":[2,2.1666666666666674],"name":"Y -> Yhat","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","mode":"lines","line":{"color":"red","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,1.1666666666666674],"y":[0,1.6666666666666674],"z":[0,2.1666666666666674],"name":"Yhat","mode":"lines","line":{"color":"orange","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[1,1.1666666666666674],"y":[2,1.6666666666666674],"z":[2,2.1666666666666674],"name":"Y -> Yhat","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><span class="math inline">\(\mathbf{Y}\)</span> is projected in the column space of <span class="math inline">\(\mathbf{X}\)</span>! spanned by the columns.</p>
</div>
<div id="how-does-this-projection-works" class="section level4" number="2.1.6.3">
<h4><span class="header-section-number">2.1.6.3</span> How does this projection works?</h4>
<p><span class="math display">\[
\begin{array}{lcl}
\hat{\mathbf{Y}} &amp;=&amp; \mathbf{X} (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}\\
&amp;=&amp; \mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1/2}(\mathbf{X}^T\mathbf{X})^{-1/2}\mathbf{X}^T\mathbf{Y}\\
&amp;=&amp; \mathbf{S}\mathbf{S}^T\mathbf{Y}
\end{array}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{S}\)</span> is a new orthonormal basis in <span class="math inline">\(\mathbb{R}^2\)</span>, a subspace of <span class="math inline">\(\mathbb{R}^3\)</span></p></li>
<li><p>The space spanned by <span class="math inline">\(\mathbf{S}\)</span> and <span class="math inline">\(\mathbf{X}\)</span> is the column space of <span class="math inline">\(\mathbf{X}\)</span>, e.g. it contains all possible linear combinantions of <span class="math inline">\(\mathbf{X}\)</span>.
<span class="math inline">\(\mathbf{S}^t\mathbf{Y}\)</span> is the projection of <span class="math inline">\(\mathbf{Y}\)</span> on this new orthonormal basis</p></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>svdX <span class="ot">&lt;-</span> <span class="fu">svd</span>(X) <span class="co"># SVD X = UDV^T</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>XtXinvSqrt <span class="ot">&lt;-</span> svdX<span class="sc">$</span>v <span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>svdX<span class="sc">$</span>d)<span class="sc">%*%</span><span class="fu">t</span>(svdX<span class="sc">$</span>v)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>S <span class="ot">&lt;-</span> X <span class="sc">%*%</span> XtXinvSqrt</span></code></pre></div>
<ul>
<li><span class="math inline">\(\mathbf{S}\)</span> orthonormal basis</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>S</span></code></pre></div>
<pre><code>##         [,1]        [,2]
## 1  0.9116067 -0.04802616
## 2  0.3881706  0.42738380
## 3 -0.1352655  0.90279376</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">t</span>(S)<span class="sc">%*%</span>S</span></code></pre></div>
<pre><code>##              [,1]         [,2]
## [1,] 1.000000e+00 2.380172e-16
## [2,] 2.380172e-16 1.000000e+00</code></pre>
<ul>
<li><span class="math inline">\(\mathbf{SS}^T\)</span> equals projection matrix</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>S<span class="sc">%*%</span><span class="fu">t</span>(S)</span></code></pre></div>
<pre><code>##            1         2          3
## 1  0.8333333 0.3333333 -0.1666667
## 2  0.3333333 0.3333333  0.3333333
## 3 -0.1666667 0.3333333  0.8333333</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>H</span></code></pre></div>
<pre><code>##            1         2          3
## 1  0.8333333 0.3333333 -0.1666667
## 2  0.3333333 0.3333333  0.3333333
## 3 -0.1666667 0.3333333  0.8333333</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p1 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">1</span>]),</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">1</span>]),</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;S1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">2</span>]),</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">2</span>]),</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">2</span>]),</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;S2&quot;</span>)</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>p3</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-6afc6736d62aab335168" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6afc6736d62aab335168">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ul>
<li><span class="math inline">\(\mathbf{S}^T\mathbf{Y}\)</span> is the projection of <span class="math inline">\(\mathbf{Y}\)</span> in the space spanned by <span class="math inline">\(\mathbf{S}\)</span>.</li>
<li>Indeed <span class="math inline">\(\mathbf{S}_1^T\mathbf{Y}\)</span></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p3 <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">1</span>]),</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">2</span>]),</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,Y[<span class="dv">3</span>]),</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Y&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,<span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Y -&gt; S1&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(Y[<span class="dv">1</span>],S[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(Y[<span class="dv">2</span>],S[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(Y[<span class="dv">3</span>],S[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Y -&gt; S1&quot;</span>)</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>p4</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-f81f2d84efdcfb49cc7b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f81f2d84efdcfb49cc7b">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.8":{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red"},"type":"scatter3d","inherit":true},"1ae127f1119.9":{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.10":{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","mode":"lines","line":{"color":"red","width":5},"type":"scatter3d","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null},{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ul>
<li>and <span class="math inline">\(\mathbf{S}_2^T\mathbf{Y}\)</span></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> p4 <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,<span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Y -&gt; S2&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(Y[<span class="dv">1</span>],S[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(Y[<span class="dv">2</span>],S[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(Y[<span class="dv">3</span>],S[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y)),</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>    <span class="at">name=</span><span class="st">&quot;Y -&gt; S2&quot;</span>)</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>p5</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-648b3c18f487c1c0fa0c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-648b3c18f487c1c0fa0c">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.8":{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red"},"type":"scatter3d","inherit":true},"1ae127f1119.9":{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.10":{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.11":{"x":[0,-0.12546012546962448],"y":[0,1.116467082810771],"z":[0,2.3583942910911668],"name":"Y -> S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.12":{"x":[1,-0.12546012546962448],"y":[2,1.116467082810771],"z":[2,2.3583942910911668],"name":"Y -> S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","mode":"lines","line":{"color":"red","width":5},"type":"scatter3d","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null},{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,-0.12546012546962448],"y":[0,1.116467082810771],"z":[0,2.3583942910911668],"name":"Y -> S2","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[1,-0.12546012546962448],"y":[2,1.116467082810771],"z":[2,2.3583942910911668],"name":"Y -> S2","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ul>
<li>Yhat is the resulting vector that lies in the plane spanned by <span class="math inline">\(\mathbf{S}_1\)</span> and <span class="math inline">\(\mathbf{S}_2\)</span> and thus also in the column space of <span class="math inline">\(\mathbf{X}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> p5 <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">1</span>]),</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">2</span>]),</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,Yhat[<span class="dv">3</span>]),</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Yhat&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(Y[<span class="dv">1</span>],Yhat[<span class="dv">1</span>]),</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(Y[<span class="dv">2</span>],Yhat[<span class="dv">2</span>]),</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(Y[<span class="dv">3</span>],Yhat[<span class="dv">3</span>]),</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;maroon2&quot;</span>),</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;e&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(S[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">1</span>]),</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(S[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">2</span>]),</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(S[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">*</span>(S[,<span class="dv">1</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">3</span>]),</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Y -&gt; S&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(S[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">1</span>]),</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(S[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">2</span>]),</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(S[<span class="dv">3</span>,<span class="dv">2</span>]<span class="sc">*</span>(S[,<span class="dv">2</span>]<span class="sc">%*%</span>Y),Yhat[<span class="dv">3</span>]),</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">dash=</span><span class="st">&quot;dash&quot;</span>),</span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Y -&gt; S&quot;</span>)</span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a>p6</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-46d4b093d4b1458b0775" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-46d4b093d4b1458b0775">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.8":{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red"},"type":"scatter3d","inherit":true},"1ae127f1119.9":{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.10":{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.11":{"x":[0,-0.12546012546962448],"y":[0,1.116467082810771],"z":[0,2.3583942910911668],"name":"Y -> S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.12":{"x":[1,-0.12546012546962448],"y":[2,1.116467082810771],"z":[2,2.3583942910911668],"name":"Y -> S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"red","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.13":{"x":[0,1.1666666666666674],"y":[0,1.6666666666666674],"z":[0,2.1666666666666674],"name":"Yhat","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"orange"},"type":"scatter3d","inherit":true},"1ae127f1119.14":{"x":[1,1.1666666666666674],"y":[2,1.6666666666666674],"z":[2,2.1666666666666674],"name":"e","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"maroon2"},"type":"scatter3d","inherit":true},"1ae127f1119.15":{"x":[1.2921267921362922,1.1666666666666674],"y":[0.55019958385589662,1.6666666666666674],"z":[-0.19172762442449892,2.1666666666666674],"name":"Y -> S","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"orange","dash":"dash"},"type":"scatter3d","inherit":true},"1ae127f1119.16":{"x":[-0.12546012546962448,1.1666666666666674],"y":[1.116467082810771,1.6666666666666674],"z":[2.3583942910911668,2.1666666666666674],"name":"Y -> S","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"orange","dash":"dash"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,0.91160672519099295],"y":[0,0.38817060670267134],"z":[0,-0.13526551178565027],"name":"S1","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,-0.048026158704263411],"y":[0,0.42738380107979479],"z":[0,0.90279376086385299],"name":"S2","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,2],"name":"Y","mode":"lines","line":{"color":"red","width":5},"type":"scatter3d","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[0,1.2921267921362922],"y":[0,0.55019958385589662],"z":[0,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null},{"x":[1,1.2921267921362922],"y":[2,0.55019958385589662],"z":[2,-0.19172762442449892],"name":"Y -> S1","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,-0.12546012546962448],"y":[0,1.116467082810771],"z":[0,2.3583942910911668],"name":"Y -> S2","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[1,-0.12546012546962448],"y":[2,1.116467082810771],"z":[2,2.3583942910911668],"name":"Y -> S2","mode":"lines","line":{"color":"red","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,1.1666666666666674],"y":[0,1.6666666666666674],"z":[0,2.1666666666666674],"name":"Yhat","mode":"lines","line":{"color":"orange","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[1,1.1666666666666674],"y":[2,1.6666666666666674],"z":[2,2.1666666666666674],"name":"e","mode":"lines","line":{"color":"maroon2","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[1.2921267921362922,1.1666666666666674],"y":[0.55019958385589662,1.6666666666666674],"z":[-0.19172762442449892,2.1666666666666674],"name":"Y -> S","mode":"lines","line":{"color":"orange","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[-0.12546012546962448,1.1666666666666674],"y":[1.116467082810771,1.6666666666666674],"z":[2.3583942910911668,2.1666666666666674],"name":"Y -> S","mode":"lines","line":{"color":"orange","width":5,"dash":"dash"},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="error" class="section level3" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Error</h3>
<p>Note, that it is also clear from the equation in the derivation of the least squares solution that the residual is orthogonal on the column space:</p>
<p><span class="math display">\[
-2 \mathbf{X}^T(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}) = 0
\]</span></p>
</div>
<div id="curse-of-dimensionality" class="section level3" number="2.1.8">
<h3><span class="header-section-number">2.1.8</span> Curse of dimensionality?</h3>
<ul>
<li><p>Imagine what happens when p approaches n <span class="math inline">\(p=n\)</span> or becomes much larger than p &gt;&gt; n!!!</p></li>
<li><p>Suppose that we add a predictor <span class="math inline">\(\mathbf{X}_2 = [2,0,1]^T\)</span>?</p></li>
</ul>
<p><span class="math display">\[
\mathbf{Y}=\left[
\begin{array}{c}
1\\
2\\
2\\
\end{array}\right],
\quad
\mathbf{X}= \left[
\begin{array}{ccc}
1&amp;1&amp;2\\
1&amp;2&amp;0\\
1&amp;3&amp;1\\
\end{array}
\right],
\quad \boldsymbol{\beta} = \left[
\begin{array}{c}
\beta_0\\
\beta_1\\
\beta_2
\end{array}
\right]
\quad
\text{and}
\quad
\boldsymbol{\epsilon}=
\left[
\begin{array}{c}
\epsilon_1\\
\epsilon_2\\
\epsilon_3
\end{array}
\right]
\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>data<span class="sc">$</span>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>x2,data)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co"># predict values on regular xy grid</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>x1pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>x2pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x1pred,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="at">x2 =</span> x2pred)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">matrix</span> (<span class="at">nrow =</span> <span class="dv">30</span>, <span class="at">ncol =</span> <span class="dv">30</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="at">data =</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(xy)))</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co"># fitted points for droplines to surface</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>th<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>ph<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a><span class="fu">scatter3D</span>(data<span class="sc">$</span>x,</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  data<span class="sc">$</span>x2,</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  Y,</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>  <span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>  <span class="at">theta =</span> th,</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>  <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,</span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;x2&quot;</span>,</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>  <span class="at">zlab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>  <span class="at">colvar=</span><span class="cn">FALSE</span>,</span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;g&quot;</span>,</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>  <span class="at">zlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>))</span></code></pre></div>
<p><img src="boltLmm_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>z.pred3D <span class="ot">&lt;-</span> <span class="fu">outer</span>(</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  x1pred,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  x2pred,</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="cf">function</span>(x1,x2)</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  {</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    fit<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x1<span class="sc">+</span>fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x2</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  })</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>x.pred3D <span class="ot">&lt;-</span> <span class="fu">outer</span>(</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>  x1pred,</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>  x2pred,</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  <span class="cf">function</span>(x,y) x)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>y.pred3D <span class="ot">&lt;-</span> <span class="fu">outer</span>(</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>  x1pred,</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  x2pred,</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  <span class="cf">function</span>(x,y) y)</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">scatter3D</span>(data<span class="sc">$</span>x,</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>  data<span class="sc">$</span>x2,</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>  data<span class="sc">$</span>y,</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>  <span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>  <span class="at">theta =</span> th,</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>  <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,</span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;x2&quot;</span>,</span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>  <span class="at">zlab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a>  <span class="at">colvar=</span><span class="cn">FALSE</span>,</span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;g&quot;</span>,</span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a>  <span class="at">zlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a><span class="fu">surf3D</span>(</span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a>  x.pred3D,</span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>  y.pred3D,</span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a>  z.pred3D,</span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>  <span class="at">col=</span><span class="st">&quot;blue&quot;</span>,</span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a>  <span class="at">facets=</span><span class="cn">NA</span>,</span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a>  <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="boltLmm_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<p>Note, that the linear regression is now a plane.</p>
<p>However, we obtain a perfect fit and all the data points are falling in the plane! 🫦</p>
<p>This is obvious if we look at the column space of X!</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>svdX <span class="ot">&lt;-</span> <span class="fu">svd</span>(X) <span class="co"># SVD X = UDV^T</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>XtXinvSqrt <span class="ot">&lt;-</span> svdX<span class="sc">$</span>v <span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>svdX<span class="sc">$</span>d)<span class="sc">%*%</span><span class="fu">t</span>(svdX<span class="sc">$</span>v)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>S <span class="ot">&lt;-</span> X <span class="sc">%*%</span> XtXinvSqrt</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> p1 <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>),</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;X3&quot;</span>)</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>p7</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-beaae0ab343d7010878a" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-beaae0ab343d7010878a">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,2],"y":[0,0],"z":[0,1],"name":"X3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"darkgreen"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,2],"y":[0,0],"z":[0,1],"name":"X3","mode":"lines","line":{"color":"darkgreen","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> p7 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">1</span>]),</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">1</span>]),</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;S1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">2</span>]),</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">2</span>]),</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">2</span>]),</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;S2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">1</span>,<span class="dv">3</span>]),</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">2</span>,<span class="dv">3</span>]),</span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">0</span>,S[<span class="dv">3</span>,<span class="dv">3</span>]),</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>,</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>,</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;S3&quot;</span>)</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>p8</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9959e01cf4ae3d8eddca" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9959e01cf4ae3d8eddca">{"x":{"visdat":{"1ae127f1119":["function () ","plotlyVisDat"]},"cur_data":"1ae127f1119","attrs":{"1ae127f1119":{"x":{},"y":{},"z":{},"name":"origin","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"1ae127f1119.1":{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.2":{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.3":{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"grey"},"type":"scatter3d","inherit":true},"1ae127f1119.4":{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.5":{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"black"},"type":"scatter3d","inherit":true},"1ae127f1119.6":{"x":[0,2],"y":[0,0],"z":[0,1],"name":"X3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"darkgreen"},"type":"scatter3d","inherit":true},"1ae127f1119.7":{"x":[0,0.49408047978220049],"y":[0,0.81609419390248461],"z":[0,-0.29979117094545316],"name":"S1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.8":{"x":[0,-0.077673605149893049],"y":[0,0.38487400381411085],"z":[0,0.91969495608658991],"name":"S2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true},"1ae127f1119.9":{"x":[0,0.86593954209356272],"y":[0,-0.43111746411709062],"z":[0,0.2535477106424735],"name":"S3","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"lines","line":{"width":5,"color":"blue"},"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"aspectmode":"cube","xaxis":{"range":[-4,4],"title":"X1"},"yaxis":{"range":[-4,4],"title":"X2"},"zaxis":{"range":[-4,4],"title":"X3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0],"y":[0],"z":[0],"name":"origin","type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0,1],"y":[0,0],"z":[0,0],"name":"obs1","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[0,0],"y":[0,1],"z":[0,0],"name":"obs2","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[0,0],"y":[0,0],"z":[0,1],"name":"obs3","mode":"lines","line":{"color":"grey","width":5},"type":"scatter3d","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[0,1],"y":[0,1],"z":[0,1],"name":"X1","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[0,1],"y":[0,2],"z":[0,3],"name":"X2","mode":"lines","line":{"color":"black","width":5},"type":"scatter3d","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[0,2],"y":[0,0],"z":[0,1],"name":"X3","mode":"lines","line":{"color":"darkgreen","width":5},"type":"scatter3d","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[0,0.49408047978220049],"y":[0,0.81609419390248461],"z":[0,-0.29979117094545316],"name":"S1","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[0,-0.077673605149893049],"y":[0,0.38487400381411085],"z":[0,0.91969495608658991],"name":"S2","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[0,0.86593954209356272],"y":[0,-0.43111746411709062],"z":[0,0.2535477106424735],"name":"S3","mode":"lines","line":{"color":"blue","width":5},"type":"scatter3d","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<ul>
<li><p>The column space now spans the entire <span class="math inline">\(\mathbb{R}^3\)</span>!</p></li>
<li><p>With the intercept and the two predictors we can thus fit every dataset that only has 3 observations for the predictors and the response.</p></li>
<li><p>So the model can no longer be used to generalise the patterns seen in the data towards the population (new observations).</p></li>
<li><p>Problem of overfitting!!!</p></li>
<li><p>If <span class="math inline">\(p &gt;&gt; n\)</span> then the problem gets even worse! Then there is even no longer a unique solution to the least squares problem…</p></li>
<li><p>Indeed, then we have more vectors/dimensions/columns in X than datapoints!</p></li>
</ul>
</div>
<div id="variance-estimator" class="section level3" number="2.1.9">
<h3><span class="header-section-number">2.1.9</span> Variance Estimator?</h3>
<p><span class="math display">\[
\begin{array}{ccl}
\hat{\boldsymbol{\Sigma}}_{\hat{\boldsymbol{\beta}}}
&amp;=&amp;\text{var}\left[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}\right]\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\text{var}\left[\mathbf{Y}\right]\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1} \text{(*)}\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T(\mathbf{I}\sigma^2)\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{I}\quad\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
%\hat{\boldmath{\Sigma}}_{\hat{\boldsymbol{\beta}}}&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T \text{var}\left[\mathbf{Y}\right](\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\\\\
&amp;=&amp;(\mathbf{X}^T\mathbf{X})^{-1}\sigma^2
\end{array}
\]</span></p>
<p>(*) Under assumption that all observations <span class="math inline">\(\mathbf{Y}\)</span> are independent and identically distributed.</p>
<p>The fact that <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is unbiased and has a variance of <span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\sigma^2\)</span> will be important when assessing association!</p>
</div>
<div id="projecting-covariates-out" class="section level3" number="2.1.10">
<h3><span class="header-section-number">2.1.10</span> Projecting covariates out</h3>
<p>We can get rid of covariates <span class="math inline">\(\mathbf{X}_c\)</span> by projecting them out, i.e. </p>
<p><span class="math display">\[
\mathbf{P}_c = (\mathbf{I} - \mathbf{X}_x(\mathbf{X}_x^T\mathbf{X}_x)^{-1}\mathbf{X}_x^T)
\]</span></p>
<p>So one obtains</p>
<p><span class="math display">\[
\begin{array}{ccccccccc}
\mathbf{P}_c \mathbf{y} &amp;=&amp; \mathbf{P}_c \mathbf{x}_\text{test}\beta_\text{test}&amp; + &amp; \mathbf{P}_c \mathbf{X}_c\boldsymbol{\beta}_c &amp;+ &amp;\mathbf{P}_c \mathbf{Zu} &amp;+&amp;\mathbf{P}_c \boldsymbol{\epsilon} \\
\tilde{\mathbf{y}} &amp;=&amp; \tilde{\mathbf{x}}_\text{test}\beta_\text{test} &amp;+&amp;\mathbf{0}&amp;+ &amp;\tilde{\mathbf{Z}}\mathbf{u} &amp;+&amp;\tilde{\boldsymbol{\epsilon}}
\end{array}
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{P}_x\)</span> projects vectors to an (N − C)-dimensional subspace orthogonal on the known covariates.</li>
<li>keep in mind that all these <span class="math inline">\(N\)</span> vectors all belong to the (N − C)-dimensional subspace!<br />
<span class="math inline">\(\rightarrow\)</span> Important when estimating <span class="math inline">\(\tilde{\mathbf{y}}\)</span> and <span class="math inline">\(\tilde{\mathbf{Z}}\)</span></li>
</ul>
</div>
</div>
<div id="bolt-lmm-uses-a-score-test-to-test-for-the-candidate-snp" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bolt-LMM uses a score test to test for the candidate SNP</h2>
<p>If all model assumptions hold we can derive a <span class="math inline">\(\chi^2\)</span> test under the null hypothesis <span class="math inline">\(H_0: \boldsymbol{\beta}=\mathbf{0}\)</span>:</p>
<p><span class="math display">\[
t=\hat{\beta}\hat{\boldsymbol{\Sigma}}_{\hat{\beta}}^{-1}\hat{\beta}
\]</span>
which follows an asymptotic <span class="math inline">\(\chi^2\)</span> distribution under <span class="math inline">\(H_0\)</span>.</p>
<p>In our case we only test for one model parameter, i.e. that of the candidate SNP so the test reduces to</p>
<p><span class="math display">\[
t_{\chi^2}=\frac{\hat{\beta}_\text{test}^2}{\text{SE}_{\hat{\beta}_\text{test}}^2}
\]</span>
which follows an asymptotic <span class="math inline">\(\chi^2_1\)</span> distribution with one degree of freedom under <span class="math inline">\(H_0\)</span>.</p>
<p>We need the estimator for <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(\hat{\boldsymbol{\Sigma}}\)</span>.</p>
<div id="intermezzo-fitting-linear-mixed-models-lmm" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Intermezzo fitting linear mixed models (LMM)</h3>
<p>In the general formulation of LMM also allow random effects to be correlated.</p>
<p><span class="math display">\[
\left\{
\begin{array}{ccc}
Y &amp;=&amp; \mathbf{X}\beta + \mathbf{Zu} + \boldsymbol{\epsilon}\\
\mathbf{u} &amp;\sim&amp;\text{MVN}(\mathbf{0},\mathbf{G})\\
\boldsymbol{\epsilon}  &amp;\sim&amp;\text{MVN}(\mathbf{0},\mathbf{I}\sigma^2_\epsilon)
\end{array}
\right.
\]</span></p>
<p>This expression implies three different model representations:</p>
<ol style="list-style-type: decimal">
<li>the conditional model (conditional on the random effects)</li>
</ol>
<p><span class="math display">\[
f(\mathbf{Y}\vert \mathbf{X, u})\sim \text{MVN}(\mathbf{X}\boldsymbol{\beta}+\mathbf{Zu},\mathbf{I}\sigma^2_\epsilon)
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>the joint model of <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{u}\)</span>
<span class="math display">\[
\begin{array}{ccl}
f(\mathbf{Y, u}\vert \mathbf{X}) &amp;\sim&amp; f(\mathbf{Y}\vert \mathbf{X, u}) f(\mathbf{u}) \\\\
&amp;\sim&amp;\text{MVN}(\mathbf{X}\boldsymbol{\beta}+\mathbf{Zu},\mathbf{I}\sigma^2_\epsilon)\times\text{MVN}(\mathbf{0},\mathbf{G})
\end{array}
\]</span></li>
<li>Marginal model of <span class="math inline">\(\mathbf{Y}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{array}{rcl}
f(\mathbf{Y}\vert \mathbf{X}) &amp;\sim&amp; \int f(\mathbf{Y, u}\vert \mathbf{X}) d\mathbf{u} \\\\
&amp;\sim&amp; \text{MVN}(\mathbf{X}\boldsymbol{\beta},\mathbf{V})\\\\
\mathbf{V} &amp;=&amp; \mathbf{ZG}\mathbf{Z}^T + \mathbf{I}\sigma^2_\epsilon
\end{array}
\]</span>
So estimating the mixed model implies estimating</p>
<ul>
<li>Model parameters of fixed effects <span class="math inline">\(\boldsymbol{\beta}\)</span></li>
<li>Variance components <span class="math inline">\(\mathbf{G}\)</span> and <span class="math inline">\(\sigma^2_\epsilon\)</span></li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> We can do that by using maximum likelihood.</p>
<ul>
<li>Choosing the data parameters as such so that the probability to observe the data under the marginal model becomes maximal</li>
</ul>
<p><span class="math display">\[
L(\boldsymbol{\beta}, \mathbf{G},\sigma^2_\epsilon \vert \mathbf{X, Y}) = \frac{1}{(2\pi)^{N/2}|\mathbf{V}|^{1/2}} \exp\left(-\frac{1}{2} (\mathbf{Y} - \mathbf{X}\boldsymbol{\beta})^T \mathbf{V}^{-1} (\mathbf{Y} - \mathbf{X}\boldsymbol{\beta})\right)
\]</span>
This is nasty to maximise <span class="math inline">\(\rightarrow\)</span> maximise the log-likelihood</p>
<p><span class="math display">\[
l(\boldsymbol{\beta}, \mathbf{G},\sigma^2_\epsilon \vert \mathbf{X, Y}) = -\frac{N}{2} \log(2\pi) - \frac{1}{2} \log(|\mathbf{V}|) - \frac{1}{2}  (\mathbf{Y} - \mathbf{X}\boldsymbol{\beta})^T \mathbf{V}^{-1} (\mathbf{Y} - \mathbf{X}\boldsymbol{\beta})
\]</span></p>
<p><span class="math display">\[
\begin{array}{rcl}
\frac{\partial}{\partial \beta} l(\boldsymbol{\beta}, \mathbf{G},\sigma^2_\epsilon \vert \mathbf{X, Y}) &amp;=&amp; 0 \\\\
\frac{1}{2} \mathbf{X}^T \mathbf{V}^{-1} (\mathbf{Y} - \mathbf{X}\boldsymbol{\beta}) &amp;=&amp; 0\\\\
\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X}\boldsymbol{\beta} &amp;=&amp;\mathbf{X}^T \mathbf{V}^{-1} \mathbf{Y}\\\\
\hat{\boldsymbol{\beta}} &amp;=&amp; (\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{V}^{-1} \mathbf{Y}
\end{array}
\]</span>
The variance-covariance matrix for this estimator becomes:</p>
<p><span class="math display">\[
\begin{array}{rcl}
\text{var}\left[\hat{\boldsymbol{\beta}}\right] &amp;=&amp; \text{var}\left[(\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{V}^{-1} \mathbf{Y}\right]\\\\
\boldsymbol{\Sigma}_\hat{\boldsymbol{\beta}} &amp;=&amp;(\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{V}^{-1} \text{var}\left[\mathbf{Y}\right] \mathbf{V}^{-1} \mathbf{X} (\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \\\\
\boldsymbol{\Sigma}_\hat{\boldsymbol{\beta}} &amp;=&amp;(\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{V}^{-1} \mathbf{V} \mathbf{V}^{-1} \mathbf{X} (\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \\\\
\boldsymbol{\Sigma}_\hat{\boldsymbol{\beta}} &amp;=&amp;(\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1}
\end{array}
\]</span>
So we only need to estimate the variance components <span class="math inline">\(\mathbf{G}\)</span> and <span class="math inline">\(\sigma_\epsilon^2\)</span>.</p>
<ul>
<li>This can be done by the profile likelihood, i.e. replacing <span class="math inline">\(\boldsymbol{\beta}\)</span> by the ML estimator <span class="math inline">\((\mathbf{X}^T \mathbf{V}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{V}^{-1} \mathbf{Y}\)</span>.</li>
<li>We then maximise the profile likelihood to <span class="math inline">\(\mathbf{G}\)</span> and <span class="math inline">\(\sigma_\epsilon^2\)</span></li>
<li>Note that the ML for the variance components are biased in small sample because it does not account for the loss in degrees of freedom due to the estimation of the fixed effect model parameters</li>
<li>Therefore, ML is often replaced by restricted maximum likelihood (REML) which adds a penalty term to the ML to correct for the loss in df.</li>
</ul>
<p>Once estimators for the variance components <span class="math inline">\(\hat{\mathbf{G}}\)</span> and <span class="math inline">\(\hat{\sigma}_\epsilon^2\)</span> are obtained we will plug them in <span class="math inline">\(\mathbf{V}\)</span>, <span class="math inline">\(\hat{\mathbf{\beta}}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}_\hat{\boldsymbol{\beta}}\)</span></p>
<p><span class="math display">\[
\begin{array}{ccl}
\hat{\mathbf{V}} &amp;=&amp; \mathbf{Z}\hat{\mathbf{G}}^{-1}\mathbf{Z}^T + \mathbf{I}\hat\sigma^2_\epsilon\\\\
\hat{\boldsymbol{\beta}} &amp;=&amp; (\mathbf{X}^T \hat{\mathbf{V}}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \hat{\mathbf{V}}^{-1} \mathbf{Y}\\\\
\hat{\boldsymbol{\Sigma}}_\hat{\boldsymbol{\beta}} &amp;=&amp;(\mathbf{X}^T \hat{\mathbf{V}}^{-1} \mathbf{X})^{-1}
\end{array}
\]</span></p>
<p>Note, that</p>
<ul>
<li><p>for our GWAS LMM <span class="math inline">\(\mathbf{G} = \mathbf{I} \sigma^2_u\)</span> and thus reduces to estimating <span class="math inline">\(\sigma^2_u\)</span></p></li>
<li><p>The optimisation for the variance components is computationally demanding</p></li>
<li><p><span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}_\hat{\boldsymbol{\beta}}\)</span> involve the computationally challenging calculation of</p>
<ul>
<li><span class="math inline">\(\hat{\mathbf{V}}^{-1}\)</span> an <span class="math inline">\(N \times N\)</span> with <span class="math inline">\(N &gt; 70.000\)</span> subjects</li>
<li><span class="math inline">\(\mathbf{Z}_{GRM}^T\mathbf{Z}\)</span> an <span class="math inline">\(M \times M\)</span> with <span class="math inline">\(M &gt; 500.000\)</span> high quality SNPs</li>
</ul></li>
</ul>
</div>
<div id="adopting-result-to-bolt-lmm" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Adopting result to BOLT-LMM</h3>
<p>Note, that in BOLT-LMM they profiled out all fixed effect except for the candidate SNP.<br />
so only one fixed effect parameter <span class="math inline">\(\hat{\beta}_\text{test}\)</span></p>
<p><span class="math display">\[
\begin{array}{ccl}
\hat{\beta}_\text{test} &amp;=&amp; (\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{x}}_\text{test})^{-1}\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{y}} \\\\
&amp;=&amp; \frac{(\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{y}})}{(\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{x}}_\text{test})}
\end{array}
\]</span>
Next, we need the <span class="math inline">\(\text{SE}_{\hat{\beta}_\text{test}}\)</span></p>
<p><span class="math display">\[
\text{SE}^2_{\hat{\beta}_\text{test}} = (\tilde{\mathbf{x}}^t_\text{test}\hat{\mathbf{V}}^{-1}\tilde{\mathbf{x}}^t_\text{test})^{-1}
\]</span>
We plug <span class="math inline">\(\hat{\beta}_\text{test}^2\)</span> and <span class="math inline">\(\text{SE}_{\hat{\beta}_\text{test}}^2\)</span> in the <span class="math inline">\(\chi^2\)</span>-test:</p>
<p><span class="math display">\[
\begin{array}{ccl}
t_{\chi^2}&amp;=&amp;\frac{\hat{\beta}_\text{test}^2}{\text{SE}_{\hat{\beta}_\text{test}}^2} \\\\
&amp;=&amp; \frac{(\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{y}})^2}{(\tilde{\mathbf{x}}^t_\text{test} \hat{\mathbf{V}}^{-1}\tilde{\mathbf{x}}_\text{test})}
\end{array}
\]</span>
which follows a <span class="math inline">\(\chi^2_1\)</span> with one degree of freedom.</p>
<p>We can construct a score test by replacing the variance components <span class="math inline">\(\sigma_\epsilon^2\)</span> and <span class="math inline">\(\sigma_u^2\)</span> by their estimates under the model implied by <span class="math inline">\(H_0: \beta_\text{test} = 0\)</span>:</p>
<p><span class="math display">\[
\tilde{\mathbf{y}} \sim \text{MVN}(\mathbf{0},\mathbf{V})
\]</span></p>
</div>
<div id="loco-score-test" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> LOCO score test</h3>
<p>Within a Leave One Chromosome Out (LOCO) scheme, the test statistic becomes</p>
<p><span class="math display">\[
\tag{4}
t_\text{LOCO} = \frac{(\tilde{\mathbf{x}}^t_\text{test} \hat{V}^{-1}_{\text{LOCO},H_0}\tilde{\mathbf{y}})^2}{\tilde{\mathbf{x}}^t_\text{test} \hat{V}^{-1}_{\text{LOCO},H_0}\tilde{\mathbf{x}}_\text{test}}
\]</span></p>
<p><span class="math inline">\(\rightarrow\)</span> effect of candidate SNP not by diluted by proximal contamination.<br />
<span class="math inline">\(\rightarrow\)</span> variance components under <span class="math inline">\(H_0\)</span><br />
<span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(\hat{V}^{-1}_{\text{LOCO}, H_0}\)</span> is the same for all candidate SNPs from the same chromosome.</p>
</div>
</div>
<div id="bolt-lmm-inf" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> BOLT-LMM-inf</h2>
<p>“The BOLT-LMM-inf infinitesimal mixed-model statistic is slightly different”</p>
<div id="denominator-loco-statistic" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Denominator LOCO statistic</h3>
<p>Under the assumption that many loci with small effects control the trait, the denominator of the LOCO score test</p>
<p><span class="math display">\[
\tilde{\mathbf{x}}^t_\text{test} {V}^{-1}_\text{LOCO}\tilde{\mathbf{x}}^t_\text{test}
\]</span></p>
<p>is very similar between all candidate SNPs</p>
<p><span class="math inline">\(\rightarrow\)</span> can be replaced by a calibration factor that only has to be estimated once!</p>
<p>The BOLT-LMM-inf statistics thus becomes:</p>
<p><span class="math display">\[t_\text{BOLT-LMM-inf} = \frac{(\tilde{\mathbf{x}}^t_\text{test} \hat{V}^{-1}_{\text{LOCO},H_0}\tilde{\mathbf{y}})^2}{c_\text{inf}}\]</span></p>
<p>which follows a <span class="math inline">\(\chi^2_1\)</span> under <span class="math inline">\(H_0\)</span>.</p>
<ul>
<li><p>Calibration factor estimated with 30 random SNPs without effect.</p></li>
<li><p>Important to keep in mind:</p></li>
</ul>
<p><span class="math display">\[ c_\text{inf} \leftrightarrow \tilde{\mathbf{x}}^T\hat{\mathbf{V}}^{-1}_{\text{LOCO},H_0}\tilde{\mathbf{x}}\]</span></p>
</div>
</div>
<div id="generalisation-of-bolt-lmm-inf" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Generalisation of BOLT-LMM-inf</h2>
<p>“We now generalize BOLT-LMM-inf by obsering that the vector <span class="math inline">\(\mathbf{V}^{-1}_{\text{LOCO},H_0} \mathbf{y}\)</span> appearing in equation (8) is a scalar multiple of the residual phenotype <span class="math inline">\(\sigma^2_\epsilon \mathbf{V}^{-1}_{\text{LOCO},H_0} \mathbf{y}\)</span> from the best linear unbiased prediction (BLUP)”</p>
<div id="what-is-the-best-linear-unbiased-predictor-blup" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> What is the best linear unbiased predictor BLUP?</h3>
<ul>
<li>The random effects can be predicted using the BLUP</li>
<li>An estimator for the fixed effects and for the prediction of the random effects can be derived from the joint-likelihood of <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{u}\)</span>, i.e. </li>
</ul>
<p>Maximising the log of the joint density <span class="math inline">\(f(\mathbf{Y},\mathbf{u}\vert \mathbf{X})\)</span> to <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\boldsymbol{\beta}\)</span>:</p>
<p><span class="math display">\[
\text{argmax}_{\mathbf{u},\boldsymbol{\beta}} \left[
-\frac{N}{2}\log( \sigma^2_\epsilon)-\frac{1}{2\sigma^2_\epsilon}\left(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}-\mathbf{Zu}\right)^T\left(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}-\mathbf{Zu}\right)-1/2\log(\vert\mathbf{G}\vert)-\frac{1}{2}\mathbf{u}^T\mathbf{G}^{-1}\mathbf{u}\right]
\]</span></p>
<p>Maximisation to <span class="math inline">\(\boldsymbol{\theta}=\left[\begin{array}{c} \boldsymbol{\beta}\\\mathbf{u}\end{array}\right]\)</span> only involves</p>
<p><span class="math display">\[
-\frac{1}{2\sigma^2_\epsilon}\left(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}-\mathbf{Zu}\right)^T\left(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta}-\mathbf{Zu}\right)-\frac{1}{2}\mathbf{u}^T\mathbf{G}^{-1}\mathbf{u}
\]</span>
which can be rewritten as a kind of loss function that we will minimise</p>
<p><span class="math display">\[
L^{MM}=(\mathbf{Y}-\mathbf{C}\boldsymbol{\theta})^T(\mathbf{Y}-\mathbf{C}\boldsymbol{\theta})+{\sigma^2_\epsilon}\boldsymbol{\theta}^T\mathbf{H}\boldsymbol{\theta}
\]</span></p>
<p>with <span class="math inline">\(\mathbf{C}=[\mathbf{X}\text{ } \mathbf{Z}]\)</span> and <span class="math inline">\(\mathbf{H}=\left[\begin{array}{cc} \mathbf{0}&amp;\mathbf{0}\\ \mathbf{0}&amp;\mathbf{G}^{-1} \end{array} \right]\)</span></p>
<p>We can find the estimator for <span class="math inline">\(\boldsymbol{\theta}\)</span> by taken the first derivative of <span class="math inline">\(L^{MM}\)</span> to <span class="math inline">\(\boldsymbol{\theta}\)</span> and setting it to zero,
<span class="math display">\[
\begin{array}{rcl}
\frac{\partial }{\partial \boldsymbol{\theta}} L^{MM} &amp;=&amp; 0\\\\
-2 \mathbf{C}^T(\mathbf{Y}-\mathbf{C}\boldsymbol{\theta})+2 {\sigma^2_\epsilon} H\boldsymbol{\theta}&amp;=&amp;0\\\\
-\mathbf{C}^T\mathbf{Y}+\mathbf{C}^T\mathbf{C}\boldsymbol{\theta}+ {\sigma^2_\epsilon} H\boldsymbol{\theta}&amp;=&amp;0\\\\
(\mathbf{C}^T\mathbf{C} + \sigma^2_\epsilon H)\boldsymbol{\theta} &amp;=&amp;\mathbf{C}^T\mathbf{Y}\\\\
\hat{\boldsymbol{\theta}} &amp;=&amp;  (\mathbf{C}^T\mathbf{C} + \sigma^2_\epsilon H)^{-1}\mathbf{C}^T\mathbf{Y}
\end{array}
\]</span></p>
<p>For our GWAS - LMM this reduces to</p>
<p><span class="math display">\[
\left[\begin{array}{c} \hat{\boldsymbol{\beta}}\\\hat{\mathbf{u}}\end{array}\right] =  
\left(
\left[
\begin{array}{cc}
\mathbf{X}^T\mathbf{X}&amp; \mathbf{X}^T\mathbf{Z}\\
\mathbf{Z}^T\mathbf{X}&amp; \mathbf{Z}^T\mathbf{Z}
\end{array}
\right] +
\frac{\sigma^2_\epsilon}{\sigma^2_u}
\left[
\begin{array}{cc}
\mathbf{0}&amp; \mathbf{0}\\
\mathbf{0}&amp; \mathbf{I}
\end{array}
\right]
\right)^{-1}
\left[
\begin{array}{c}
\mathbf{X}^T\\
\mathbf{Z}^T
\end{array}
\right]\mathbf{Y}
\]</span></p>
<p>It can also be shown that <span class="math inline">\(\hat{\mathbf{u}}\)</span> for the conventional LMM equals</p>
<p><span class="math display">\[
\hat{\mathbf{u}}= \hat{\mathbf{G}}\mathbf{Z}^T\hat{\mathbf{V}}^{− 1} (\mathbf{Y} − \mathbf{X} \hat{\boldsymbol{\beta}})
\]</span></p>
<p>and for our GWAS-LMM</p>
<p><span class="math display">\[
\hat{\mathbf{u}}= \hat{\sigma}^2_u\mathbf{Z}^T\hat{\mathbf{V}}^{− 1} (\mathbf{Y} − \mathbf{X} \hat{\boldsymbol{\beta}})
\]</span></p>
</div>
<div id="adopting-result-to-the-nominator-loco-statistic-of-the-bolt-lmm-inf-statistic" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Adopting result to the Nominator LOCO statistic of the BOLT-LMM-inf statistic</h3>
<p>Moreover, under <span class="math inline">\(H_0: \beta_\text{test}=0\)</span> the BLUP for the LOCO SNPs becomes</p>
<p><span class="math display">\[
\hat{\mathbf{u}}_{\text{LOCO}, H_0} = \hat\sigma^2_{u,\text{LOCO},H_0}\mathbf{Z}^T\hat{\mathbf{V}}^{− 1}_{\text{LOCO}, H_0} \tilde{\mathbf{y}}
\]</span>
<span class="math inline">\(\rightarrow\)</span> BLUP residuals become</p>
<p><span class="math display">\[
\begin{array}{ccl}
\mathbf{y}_\text{residual-LOCO, H_0} &amp;=&amp; \tilde{\mathbf{y}} - \mathbf{Z}\hat{\mathbf{u}}_{\text{LOCO}, H_0}\\ \\
&amp;=&amp; \hat{\mathbf{V}}_{\text{LOCO}, H_0}\hat{\mathbf{V}}_{\text{LOCO}, H_0}^{-1}\tilde{\mathbf{y}}-\mathbf{Z}\mathbf{Z}^T\hat\sigma^2_{u,\text{LOCO},H_0} \hat{\mathbf{V}}_{\text{LOCO}, H_0}^{-1}\tilde{\mathbf{y}} \\\\
&amp;=&amp; (\hat{\mathbf{V}}_{\text{LOCO}, H_0}-\mathbf{Z}\mathbf{Z}^T\hat\sigma^2_{u,\text{LOCO},H_0}) \hat{\mathbf{V}}_{\text{LOCO}, H_0}^{-1}\tilde{\mathbf{y}} \\\\
&amp;=&amp; (\mathbf{Z}^T\mathbf{Z}\hat{\sigma}^2_{u\text{LOCO}, H_0}+\mathbf{I}\hat{\sigma}^2\epsilon-\mathbf{Z}\mathbf{Z}^T\hat\sigma^2_{u,\text{LOCO},H_0}) \hat{\mathbf{V}}_{\text{LOCO}, H_0}^{-1}\tilde{\mathbf{y}} \\\\
&amp;=&amp; \hat\sigma^2_{\epsilon,LOCO,H_0}\hat{\mathbf{V}}_{\text{LOCO}, H_0}^{-1}\tilde{\mathbf{y}}
\end{array}
\]</span>
<span class="math inline">\(\rightarrow\)</span> nominator of LOCO score test upon a factor equal to:</p>
<p><span class="math display">\[
(\tilde{\mathbf{x}}^t_\text{test} \mathbf{y}_\text{residual-LOCO, H_0})^2
\]</span></p>
<p>BOLT-LMM-inf statistic thus becomes:</p>
<p><span class="math display">\[t_\text{BOLT-LMM-inf} = \frac{(\tilde{\mathbf{x}}^t_\text{test} \mathbf{y}_\text{residual-LOCO, H_0})^2}{c}\]</span>
with c the adjusted calibration factor.</p>
</div>
</div>
<div id="bolt-lmm-gaussian-mixture-model-association-test" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> BOLT-LMM Gaussian mixture-model association test</h2>
<p>To generalise the estimation to non-infinitesimal genetic architextures they replace the Gaussian prior on the SNP effects sizes <span class="math inline">\(u_m\)</span> by a
Gaussian mixture prior :</p>
<p><span class="math display">\[u_m \sim p N(0,\sigma^2_{u,1}) + (1-p) N(0,\sigma^2_{u,2})\]</span></p>
<p>with a small probability <span class="math inline">\(p &lt;&lt; 1\)</span> and <span class="math inline">\(\sigma^2_{u,1} &gt;&gt; \sigma^2_{u,2}\)</span>.</p>
<ul>
<li><p>“This mixture more flexibly models the heavier-tailed distributions of the genetic effects of typical (non-infinitesimal) phenotypes.”</p></li>
<li><p>“The first component in the mixture is a ‘slab’ that models the existence of a small number of loci with relatively large effects and the second component is a ‘spike’ that models the assumption that most SNPs have an effect of nearly—but not exactly—zero on the phenotype.”</p></li>
<li><p>“(Note, however, that all SNPs are assigned the same mixture prior; that is, SNPs are not individually allocated to one or the other component.)”</p></li>
<li><p>“It is important that the spike component have nonzero variance so as to capture genome-wide effects on phenotype such as ancestry or relatedness; then, when testing SNPs for association, these genome-wide effects are conditioned out from residual phenotypes, protecting against confounding.”</p></li>
<li><p>“Under this generalized model, posterior means no longer correspond to BLUP, but we can still approximately fit the Bayesian model (once per left-out chromosome) and obtain residuals”</p></li>
<li><p>“Plugging these residuals into equation (11) gives the BOLT-LMM Gaussian mixture-model association test statistic.”</p></li>
</ul>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiVW5kZXIgdGhlIGhvb2Qgb2YgQk9MVC1MTU0iCmF1dGhvcjogIkxpZXZlbiBDbGVtZW50IgpkYXRlOiAic3RhdE9taWNzLCBHaGVudCBVbml2ZXJzaXR5IChodHRwczovL3N0YXRvbWljcy5naXRodWIuaW8pIgpvdXRwdXQ6CiAgICBib29rZG93bjo6aHRtbF9kb2N1bWVudDI6CiAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgICAgZGZfcHJpbnQ6IHBhZ2VkCiAgICAgIHRoZW1lOiBmbGF0bHkKICAgICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgICB0b2M6IHRydWUKICAgICAgdG9jX2Zsb2F0OiB0cnVlCiAgICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQogICAgICBjb2RlX2ZvbGRpbmc6IHNob3cKLS0tCgpgYGB7ciBsaWJyYXJpZXMsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0UsIGVjaG89RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQpsaWJyYXJ5KHBsb3RseSkKYGBgCgotIFtCT0xULUxNTSBwYXBlcl0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNDM0MjI5Ny9wZGYvbmlobXM2NTAyODQucGRmKQotIFtTdXBwbGVtZW50YXJ5IEluZm9ybWF0aW9uXShodHRwczovL3N0YXRpYy1jb250ZW50LnNwcmluZ2VyLmNvbS9lc20vYXJ0JTNBMTAuMTAzOCUyRm5nLjMxOTAvTWVkaWFPYmplY3RzLzQxNTg4XzIwMTVfQkZuZzMxOTBfTU9FU001X0VTTS5wZGYpCgoKCiMgTGluZWFyIG1peGVkIG1vZGVsIGZvciBHV0FTCgojIyBTcGVjaWZpY2F0aW9uCgokJApcdGFnezF9ClxtYXRoYmZ7WX0gPSBcbWF0aGJme3h9X1x0ZXh0e3Rlc3R9XGJldGFfXHRleHR7dGVzdH0gKyBcbWF0aGJme1h9X2NcYm9sZHN5bWJvbHtcYmV0YX1fYyArIFxtYXRoYmZ7Wn1fe0dSTX1cbWF0aGJme3V9ICtcYm9sZHN5bWJvbHtcZXBzaWxvbn0gCiQkCndpdGggCgotICRcbWF0aGJme1l9JCBhbiAkTlx0aW1lczEkIHZlY3RvciBvZiB0aGUgcGhlbm90eXBlCi0gJFxtYXRoYmZ7eH1fXHRleHR7dGVzdH0kIGFuICROXHRpbWVzMSQgdmVjdG9yIHdpdGggdGhlIGdlbm90eXBlIGZvciB0aGUgY2FuZGlkYXRlIFNOUAotICRcYmV0YV9cdGV4dHt0ZXN0fSQgdGhlIGFzc29jaWF0aW9uIG9mIGNhbmRpZGF0ZSBTTlAgYW5kIHRoZSBwaGVub3R5cGUKLSAkXG1hdGhiZntYfV9jJCBhbiAkTlx0aW1lcyBwJCBtYXRyaXggd2l0aCB0aGUgY292YXJpYXRlIHBhdHRlcm4gZm9yICRDJCBrbm93biBjb3ZhcmlhdGVzICh2ZWN0b3Igb2Ygb25lcyAoaW50ZXJjZXB0KSwgYWdlLCBnZW5kZXIsIGJhdGNoLC4uLikgCi0gJFxib2xkc3ltYm9se1xiZXRhfV9jJCB0aGUgJHBcdGltZXMgMSQgdmVjdG9yIG9mIHBhcmFtZXRlcnMgbW9kZWxpbmcgdGhlIGFzc29jaWF0aW9uIG9mIHRoZSBwIGNvdmFyaWF0ZXMgYW5kIHRoZSBwaGVub3R5cGUuIAotICRcbWF0aGJme1p9JCBhbiAkTlx0aW1lcyBNJCBnZW5ldGljIHJlbGF0aW9uc2hpcCBtYXRyaXggKEdSTSkgd2l0aCBhbGwgbm9ybWFsaXNlZCBnZW5vdHlwZXMKLSAkXG1hdGhiZnt1fSQgYW4gJE1cdGltZXMgMSQgdmVjdG9yIHdpdGggaS5pLmQuIHJhbmRvbSBlZmZlY3QgZm9yIGVhY2ggU05QICRcbWF0aGJme3V9XHNpbSBcdGV4dHtNVk59KDAsXG1hdGhiZntJfVxzaWdtYV91XjIpJAotICRcYm9sZHN5bWJvbHtcZXBzaWxvbn0kIGFuICROXHRpbWVzIDEkIHZlY3RvciB3aXRoIGVudmlyb25tZW50YWwgcmVzaWR1YWxzIHRoYXQgYXJlIGFzc3VtZWQgdG8gYmUgaW5kZXBlbmRlbnQgb2YgJFxtYXRoYmZ7dX0kIGFuZCBpLmkuZC4gICRcYm9sZHN5bWJvbHtcZXBzaWxvbn1cc2ltIFx0ZXh0e01WTn0oMCxcbWF0aGJme0l9XHNpZ21hX1xlcHNpbG9uXjIpJAoKUmFuZG9tIGVmZmVjdHMgYXJlIHVzZWQgdG8gbW9kZWwgdGhlIGNvcnJlbGF0aW9uIHN0cnVjdHVyZSBpbiB0aGUgZGF0YS4gVGhleSBpbXBseSBhIGNlcnRhaW4gY292YXJpYW5jZSBzdHJ1Y3R1cmUgb2YgJFxtYXRoYmZ7eX0kCgojIyBDb3ZhcmlhbmNlIHN0cnVjdHVyZQoKQ292YXJpYW5jZSBzdHJ1Y3R1cmUgb2YgJFxtYXRoYmZ7eX0kIGltcGxpZWQgYnkgR1dBUyBtaXhlZCBtb2RlbDogCgokJApcYmVnaW57YXJyYXl9e2NjbH0KXHRleHR7dmFyfVxsZWZ0W1xtYXRoYmZ7WX1ccmlnaHRdICY9JiBcdGV4dHt2YXJ9XGxlZnRbXG1hdGhiZnt4fV9cdGV4dHt0ZXN0fVxiZXRhX1x0ZXh0e3Rlc3R9ICsgXG1hdGhiZntYfV9jXGJvbGRzeW1ib2x7XGJldGF9X2MgKyBcbWF0aGJme1p9X1x0ZXh0e0dSTX1cbWF0aGJme3V9ICtcYm9sZHN5bWJvbHtcZXBzaWxvbn1ccmlnaHRdXFxcXAomXHVwZG93bmFycm93JiBcbWF0aGJme3V9IFxwZXJwIFxib2xkc3ltYm9se1xlcHNpbG9ufVxcXFwKJj0mIFx0ZXh0e3Zhcn1bXG1hdGhiZntafV9cdGV4dHtHUk19XG1hdGhiZnt1fV0gKyBcdGV4dHt2YXJ9W1xib2xkc3ltYm9se1xlcHNpbG9ufV1cXFxcCiY9JlxtYXRoYmZ7Wn1fXHRleHR7R1JNfVx0ZXh0e3Zhcn1bXG1hdGhiZnt1fV1cbWF0aGJme1p9X1x0ZXh0e0dSTX1eVCArIFxtYXRoYmZ7SX0gXHNpZ21hXjJcXFxcCiY9JlxtYXRoYmZ7Wn1fXHRleHR7R1JNfVxtYXRoYmZ7SX1cc2lnbWFeMl91XG1hdGhiZntafV9cdGV4dHtHUk19XlQgKyBcbWF0aGJme0l9IFxzaWdtYV4yX1xlcHNpbG9uIFxcXFwKJj0mXG1hdGhiZntafV9cdGV4dHtHUk19XG1hdGhiZntafV9cdGV4dHtHUk19XlQgXHNpZ21hXjJfdSsgXG1hdGhiZntJfSBcc2lnbWFeMl9cZXBzaWxvbgpcZW5ke2FycmF5fQokJAoKTm90ZSB0aGF0IHRoZSBtb2RlbCBpcyBvZnRlbiBhbHNvIHdyaXR0ZW4gaW4gYW5vdGhlciB3YXk6CgokJApcdGFnezF9ClxtYXRoYmZ7WX0gPSBcbWF0aGJme3h9X1x0ZXh0e3Rlc3R9XGJldGFfXHRleHR7dGVzdH0gKyBcbWF0aGJme1h9X2NcYm9sZHN5bWJvbHtcYmV0YX1fYyArIFxtYXRoYmZ7Z30gK1xib2xkc3ltYm9se1xlcHNpbG9ufSAKJCQKCi0gd2l0aCAkXG1hdGhiZntnfSBcc2ltIFx0ZXh0e01WTn0oXG1hdGhiZnswfSxcbWF0aGJme0t9XHNpZ21hXjJfZykkIAoKCi0gJFxtYXRoYmZ7S30kIHRoZSAkTiBcdGltZXMgTiQgZW1waXJpY2FsIGtpbnNoaXAgbWF0cml4IAoKJCQKXG1hdGhiZntLfSA9IFxmcmFje1xtYXRoYmZ7Wn1fXHRleHR7R1JNfVxtYXRoYmZ7Wn1eVF9cdGV4dHtHUk19fXtNfSAKJCQgCgotICRcc2lnbWFfZ14yJCB0aGUgcG9seWdlbmljIHZhcmlhbmNlICRcc2lnbWFfZ14yPU1cc2lnbWFfdV4yJAoKIyMgTWFpbiBhZHZhbnRhZ2VzIG9mIExNTSBtZXRob2QKCjEuIFByZXZlbnRpb24gb2YgZmFsc2UgcG9zaXRpdmUgYXNzb2NpYXRpb25zIGR1ZSB0byBwb3B1bGF0aW9uIG9yIHJlbGF0ZWRuZXNzIHN0cnVjdHVyZSAKMi4gQW4gaW5jcmVhc2UgaW4gcG93ZXIgb2J0YWluZWQgdGhyb3VnaCB0aGUgYXBwbGljYXRpb24gb2YgYSBjb3JyZWN0aW9uIHRoYXQgaXMgc3BlY2lmaWMgdG8gdGhpcyBzdHJ1Y3R1cmUuIAozLiBMTU0gY2FuIGFsc28gaW5jcmVhc2UgcG93ZXIgYnkgaW1wbGljaXRseSBjb25kaXRpb25pbmcgb24gYXNzb2NpYXRlZCBsb2NpIG90aGVyIHRoYW4gdGhlIGNhbmRpZGF0ZSBsb2N1cy4gCgojIyBQaXRmYWxscyBvZiBMTU0KCjEuIENvbXB1dGF0aW9uYWwgY29tcGxleGl0eTogCgogIC0gJE0gPiA1MDAuMDAwJCwgJE4gPiA3MDAwMCQKICAtIEJ1aWxkaW5nIHRoZSBHUk0gKCRNIFx0aW1lcyBNJCBtYXRyaXgpCiAgLSBFc3RpbWF0aW5nIHRoZSBtZWFuIGFuZCB2YXJpYW5jZSBjb21wb25lbnRzICBmb3IgZWFjaCBvZiB0aGUgJE0kIGNhbmRpZGF0ZSBTTlAhIAogIC0gQXNzb2NpYXRpb24gc3RhdGlzdGljcyBmb3IgZWFjaCB2YXJpYW50IChmb3IgZWFjaCBTTlAhKQoKMi4gTG9zcyBpbiBwb3dlciB3aGVuIHRoZSBjYW5kaWRhdGUgbWFya2VyIGlzIGluY2x1ZGVkIGluIHRoZSBHUk0KCjMuIFVzaW5nIGEgc21hbGwgc3Vic2V0IG9mIG1hcmtlcnMgaW4gdGhlIEdSTSBjYW4gY29tcHJvbWlzZSBjb3JyZWN0aW9uIGZvciBzdHJhdGlmaWNhdGlvbgoKIyBCb2x0IExNTSAKCldoYXQgZG9lcyBwcm9qZWN0aW5nIG91dCBjb3ZhcmlhdGVzICRcbWF0aGJme1h9X2MkIG1lYW4/IAoKIyMgSW50ZXJtZXp6byBQcm9qZWN0aW9ucyAKCkxpbmVhciByZWdyZXNzaW9uIGFuZCBsZWFzdCBzcXVhcmVzIGFyZSBwcm9qZWN0aW9ucy4gCgojIyMgVG95LURhdGEKCkNvbnNpZGVyIHRoZSBmb2xsb3dpbmcgdG95LWRhdGFzZXQgd2l0aCAzIG9ic2VydmF0aW9uIChYLFkpOgoKYGBge3J9CmxpYnJhcnkodGlkeXZlcnNlKQpkYXRhIDwtIGRhdGEuZnJhbWUoeD0xOjMseT1jKDEsMiwyKSkKZGF0YQpgYGAKCiMjIyBTY2FsYXIgbW9kZWwgZm9ybQoKLSBDb25zaWRlciBhIHZlY3RvciBvZiBwcmVkaWN0b3JzICRcbWF0aGJme3h9PSh4XzEsXGxkb3RzLHhfcCkkIGFuZAotIGEgcmVhbC12YWx1ZWQgcmVzcG9uc2UgJFkkCi0gdGhlbiB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gbW9kZWwgY2FuIGJlIHdyaXR0ZW4gYXMKXFsKeV9pPVxiZXRhXzArXHN1bVxsaW1pdHNfe2o9MX1ecCB4X3tpan1cYmV0YV9qICsgXGVwc2lsb24KXF0KCgpTY2FsYXIgbW9kZWwgZm9yIHRoZSB0b3kgZGF0YXNldAoKJCQKeV9pPVxiZXRhXzArXGJldGFfMXggKyBcZXBzaWxvbl9pCiQkCgpJZiB3ZSB3cml0ZSB0aGUgbW9kZWwgZm9yIGVhY2ggb2JzZXJ2YXRpb246CgokJApcYmVnaW57YXJyYXl9IHtsY2x9CjEgJj0mIFxiZXRhXzArXGJldGFfMSAxICArIFxlcHNpbG9uXzEgXFwKMiAmPSYgXGJldGFfMCArIFxiZXRhXzEgMiArIFxlcHNpbG9uXzIgXFwKMiAmPSYgXGJldGFfMCtcYmV0YV8xIDMrIFxlcHNpbG9uXzMgXFwKXGVuZHthcnJheX0KJCQKCgojIyMgVmVjdG9yL01hdHJpeCBmb3JtCgotICRuJCBvYnNlcnZhdGlvbnMgJChcbWF0aGJme3h9XzEseV8xKSBcbGRvdHMgKFxtYXRoYmZ7eH1fbix5X24pJCB3aXRoICRcbWF0aGJme3h9XzFeVD1bXGJlZ2lue2FycmF5fXtjY2NjfSAxJiB4XzEmIFxsZG90cyYgeF9wXGVuZHthcnJheX1dJAotIFJlZ3Jlc3Npb24gaW4gbWF0cml4IG5vdGF0aW9uClxbXG1hdGhiZntZfT1cbWF0aGJme1hcYmV0YX0gKyBcbWF0aGJme1xlcHNpbG9ufVxdCndpdGggJFxtYXRoYmZ7WX09XGxlZnRbXGJlZ2lue2FycmF5fXtjfXlfMVxcIFx2ZG90c1xceV9uXGVuZHthcnJheX1ccmlnaHRdJCwKJFxtYXRoYmZ7WH09XGxlZnRbXGJlZ2lue2FycmF5fXtjY2NjfSAxJnhfezExfSZcbGRvdHMmeF97MXB9XFwKXHZkb3RzJlx2ZG90cyYmXHZkb3RzXFwKMSZ4X3tuMX0mXGxkb3RzJnhfe25wfQpcZW5ke2FycmF5fVxyaWdodF0kIG9yICRcbWF0aGJme1h9PVxsZWZ0W1xiZWdpbnthcnJheX17Y30gXG1hdGhiZnt4fV8xXlRcXFx2ZG90c1xcXG1hdGhiZnt4fV9uXlRcZW5ke2FycmF5fVxyaWdodF0kLAokXGJvbGRzeW1ib2x7XGJldGF9PVxsZWZ0W1xiZWdpbnthcnJheX17Y31cYmV0YV8wXFwgXHZkb3RzXFwgXGJldGFfcFxlbmR7YXJyYXl9XHJpZ2h0XSQgYW5kCiRcbWF0aGJme1xlcHNpbG9ufT1cbGVmdFtcYmVnaW57YXJyYXl9e2N9IFxlcHNpbG9uXzEgXFwgXHZkb3RzIFxcIFxlcHNpbG9uX25cZW5ke2FycmF5fVxyaWdodF0kCgoKQXBwbGljYXRpb24gdG8gdG95IGRhdGFzZXQ6IAoKJCQKXG1hdGhiZntZfSA9IFxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX0rXGJvbGRzeW1ib2x7XGVwc2lsb259CiQkCgp3aXRoCgokJApcbWF0aGJme1l9PVxsZWZ0WwpcYmVnaW57YXJyYXl9e2N9CjFcXAoyXFwKMlxcClxlbmR7YXJyYXl9XHJpZ2h0XSwKXHF1YWQKXG1hdGhiZntYfT0gXGxlZnRbClxiZWdpbnthcnJheX17Y2N9CjEmMVxcCjEmMlxcCjEmM1xcClxlbmR7YXJyYXl9ClxyaWdodF0sClxxdWFkIFxib2xkc3ltYm9se1xiZXRhfSA9IFxsZWZ0WwpcYmVnaW57YXJyYXl9e2N9ClxiZXRhXzBcXApcYmV0YV8xXFwKXGVuZHthcnJheX0KXHJpZ2h0XQpccXVhZApcdGV4dHthbmR9ClxxdWFkClxib2xkc3ltYm9se1xlcHNpbG9ufT0KXGxlZnRbClxiZWdpbnthcnJheX17Y30KXGVwc2lsb25fMVxcClxlcHNpbG9uXzJcXApcZXBzaWxvbl8zClxlbmR7YXJyYXl9ClxyaWdodF0KJCQKCiMjIyBJbnRlcnByZXRhdGlvbgoKRnJvbSB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gd2UgZ2V0ClxbCiAgRVtZIFxtaWQgXG1hdGhiZnt4fV0gPSBcbWF0aGJme3h9XlRcYm9sZHN5bWJvbHtcYmV0YX0gLgpcXQoKLSBIZW5jZSwgdGhlICRcYmV0YSQgcGFyYW1ldGVycyByZWxhdGUgdGhlIHByZWRpY3RvciAkXG1hdGhiZnt4fSQgdG8gdGhlIG1lYW4gb3V0Y29tZS4KLSBJZiB3ZSBrbm93IHRoZSBjb3ZhcmlhdGUgcGF0dGVybiAkXG1hdGhiZnt4fSQgd2UgY2FuIHVzZSB0aGUgbW9kZWwgdG8KcHJlZGljdCAkWSQuCgpGb3IgYSBtb2RlbCB3aXRoIGEgc2luZ2xlIHByZWRpY3RvciwgZS5nLiBZIGlzIEJNSSBhbmQgJHhfMSQgaXMgYmxvb2RwcmVzc3VyZSAoQlApIHdlIG9idGFpbgoKXFsKRVtZIFxtaWQgeF8xXSA9IFxiZXRhXzAgKyBcYmV0YV8xIHhfMQpcXQphbmQKXFsKXGJlZ2lue2FycmF5fXtyY2NsfQogXGJldGFfMSAmPSYgRVtZXG1pZCB4XzE9YisxXSAmLSBFW1lcbWlkIHhfMT1iXSBcXAogJj0mIFxiZXRhXzAgKyBcYmV0YV8xIChiKzEpJiAtIFxiZXRhXzAgLSBcYmV0YV8xIGIKIFxlbmR7YXJyYXl9ClxdCgotIFRoZSBwYXJhbWV0ZXIgICRcYmV0YV8xJCBoYXMgYW4gaW50ZXJwcmV0YXRpb24gYXMgdGhlIGF2ZXJhZ2UgZGlmZmVyZW5jZSBpbiBCTUkgYmV0d2VlbiBzdWJqZWN0cyB0aGF0IGRpZmZlciB3aXRoIDFtbUhHIGluIEJQLgoKLSBUaGUgcGFyYW1ldGVyICAkXGJldGFfMSQgIGRvZXMgbm90IHNheSBtdWNoIGFib3V0IGluZGl2aWR1YWwgb3V0Y29tZXMuIFRoZSByZXNpZHVhbCB2YXJpYW5jZSAkXHNpZ21hXjIkIGRldGVybWluZXMgaG93IG11Y2ggaW5kaXZpZHVhbCBvdXRjb21lcyB2YXJ5IGFib3V0IHRoZSBtZWFuIG91dGNvbWUuCgoKRm9yIGEgbW9kZWwgd2l0aCBtdWx0aXBsZSBwcmVkaWN0b3JzOiBCUCAoJHhfMSQpLCBzZXggKCR4XzIkKSwgYWdlICgkeF8zJCkgd2Ugb2J0YWluCgpcWwpFW1kgXG1pZCB4XzEsIHhfMiwgeF8zXSA9IFxiZXRhXzAgKyBcYmV0YV8xIHhfMSArIFxiZXRhXzIgeF8yICsgXGJldGFfMyB4XzMgClxdCmFuZApcWwpcYmVnaW57YXJyYXl9e3JjbH0KIFxiZXRhXzEgJj0mIEVbWVxtaWQgeF8xPWIrMSwgeF8yPXMsIHhfMyA9IGFdIC0gRVtZXG1pZCB4XzE9YiwgeF8yPXMsIHhfMyA9IGFdXFxcXCAKICY9JiBcYmV0YV8wICsgXGJldGFfMSAoYisxKSArIFxiZXRhXzMgcyArIFxiZXRhXzMgYSAgLSBcYmV0YV8wIC0gXGJldGFfMSBiIC0gXGJldGFfMyBzIC0gXGJldGFfMyBhLgpcZW5ke2FycmF5fQpcXQoKLSBUaGUgcGFyYW1ldGVyICAkXGJldGFfMSQgaGFzIGFuIGludGVycHJldGF0aW9uIGFzIHRoZSBhdmVyYWdlIGRpZmZlcmVuY2UgaW4gQk1JIGJldHdlZW4gc3ViamVjdHMgb2YgdGhlIHNhbWUgc2V4IGFuZCB0aGUgc2FtZSBhZ2UgdGhhdCBkaWZmZXIgMSBtbUhnIGluIEJQLgotIG9yIGF2ZXJhZ2UgZGlmZmVyZW5jZSBpbiBCTUkgYmV0d2VlbiBzdWJqZWN0cyB0aGF0IGRpZmZlciAxIG1tSGcgaW4gQlAgd2hpbGUgY29udHJvbGxpbmcgZm9yIGFnZSBhbmQgZ2VuZGVyLgoKCgpUaGUgJFxib2xkc3ltYm9se1xiZXRhfSQgcGFyYW1ldGVycyBhcmUgdXNlZCB0byBtZWFzdXJlIGFzc29jaWF0aW9uLCBidXQgYSAkXGJvbGRzeW1ib2x7XGJldGF9IFxuZXEgXG1hdGhiZnswfSQgZG9lcyBub3QgbmVjZXNzYXJpbHkgbWVhbiB0aGF0IHRoZSBtb2RlbCB3aWxsIGdpdmUgZ29vZCBwcmVkaWN0aW9ucy4KCiQkClxoYXQgWSA9IFxtYXRoYmZ7eH1eVCBcaGF0IFxiZXRhCiQkCk1vZGVsIGZpdCBhbmQgcHJlZGljdGlvbnMgYmFzZWQgb24gdGhlIHRveSBkYXRhc2V0CgpgYGB7ciBlY2hvPUZBTFNFLCB3YXJuaW5nPUZBTFNFLG1lc3NhZ2U9RkFMU0V9CmxtMSA8LSBsbSh5fngsZGF0YSkKZGF0YSR5aGF0IDwtIGxtMSRmaXR0ZWQKCmRhdGEgJT4lCiAgZ2dwbG90KGFlcyh4LHkpKSArCiAgZ2VvbV9wb2ludCgpICsKICB5bGltKDAsNCkgKwogIHhsaW0oMCw0KSArCiAgc3RhdF9zbW9vdGgobWV0aG9kID0gImxtIiwgY29sb3IgPSAicmVkIiwgZnVsbHJhbmdlID0gVFJVRSkgKwogIGdlb21fcG9pbnQoYWVzKHg9eCwgeSA9eWhhdCksIHBjaCA9IDIsIHNpemUgPSAzLCBjb2xvciA9ICJyZWQiKSArCiAgZ2VvbV9zZWdtZW50KGRhdGEgPSBkYXRhLCBhZXMoeCA9IHgsIHhlbmQgPSB4LCB5ID0geSwgeWVuZCA9IHloYXQpLCBsdHkgPSAyICkKYGBgCgojIyMgRXN0aW1hdGlvbiBvZiAkXGJvbGRzeW1ib2x7XGJldGF9JAojIyMjIE9yZGluYXJ5IExlYXN0IFNxdWFyZXMgKE9MUykKCi0gTWluaW1pemUgdGhlIHN1bSBvZiBzcXVhcmVzIG9mIHRoZSBlcnJvcnMKXGJlZ2lue2VxbmFycmF5Kn0KXHRleHR7U1NFfShcYm9sZHN5bWJvbHtcYmV0YX0pJj0mXHN1bVxsaW1pdHNfe2k9MX1ebiBlXjJfaVxcXFwKJj0mXHN1bVxsaW1pdHNfe2k9MX1ebiBcbGVmdCh5X2ktXGJldGFfMC1cc3VtXGxpbWl0c197aj0xfV5wIHhfe2lqfVxiZXRhX2pccmlnaHQpXjIKXGVuZHtlcW5hcnJheSp9CgotIG9yIGluIG1hdHJpeCBub3RhdGlvbgpcYmVnaW57ZXFuYXJyYXkqfQpcdGV4dHtTU0V9KFxib2xkc3ltYm9se1xiZXRhfSkmPSZcbWF0aGJme2V9XlRcbWF0aGJme2V9XFxcXAomPSYgXGxlZnRbXGJlZ2lue2FycmF5fXtjY2N9IGVfMSAmXGxkb3RzJiBlX24gXGVuZHthcnJheX1ccmlnaHRdXGxlZnRbXGJlZ2lue2FycmF5fXtjfWVfMVxcXHZkb3RzXFxlX25cZW5ke2FycmF5fVxyaWdodF1cXAomPSYgZV8xXjIgKyBlXzJeMiArIFxsZG90cyArIGVfbl4yXFxcXAomPSYoXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pXlQoXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pXFxcXAomPSZcVmVydCBcbWF0aGJme1l9LVxtYXRoYmZ7WFxiZXRhfVxWZXJ0XjJfMlxcClxlbmR7ZXFuYXJyYXkqfQp3aXRoIHRoZSAkTF8yJC1ub3JtIG9mIGEgJHAkLWRpbS4gdmVjdG9yICR2JCAkXFZlcnQgXG1hdGhiZnt2fSBcVmVydF8yPVxzcXJ0e3ZfMV4yK1xsZG90cyt2X3BeMn0kICAgIAokXHJpZ2h0YXJyb3ckICRcaGF0e1xib2xkc3ltYm9se1xiZXRhfX09XHRleHR7YXJnbWlufV9cYmV0YSBcVmVydCBcbWF0aGJme1l9LVxtYXRoYmZ7WFxiZXRhfVxWZXJ0XjJfMiQKCgotLS0KCiMjIyMgTWluaW1pemUgU1NFClxbClxiZWdpbnthcnJheX17Y2NjfQpcZnJhY3tccGFydGlhbH17XHBhcnRpYWwgXGJvbGRzeW1ib2x7XGJldGF9fSBcdGV4dHtTU0V9Jj0mXG1hdGhiZnswfVxcXFwKXGZyYWN7XHBhcnRpYWx9e1xwYXJ0aWFsIFxib2xkc3ltYm9se1xiZXRhfX0oXG1hdGhiZntZfS1cbWF0aGJme1hcYmV0YX0pXlQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9KSY9JlxtYXRoYmZ7MH1cXFxcCi0yXG1hdGhiZntYfV5UKFxtYXRoYmZ7WX0tXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfSkmPSZcbWF0aGJmezB9XFxcXAotMlxtYXRoYmZ7WH1eVFxtYXRoYmZ7WX0gKyAyXG1hdGhiZntYfV5UXG1hdGhiZntYXGJldGF9Jj0mMFxcXFwKXG1hdGhiZntYfV5UXG1hdGhiZntYXGJldGF9Jj0mXG1hdGhiZntYfV5UXG1hdGhiZntZfVxcXFwKXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19Jj0mKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme1l9ClxlbmR7YXJyYXl9ClxdCgpJdCBjYW4gYmUgc2hvd24gdGhhdCB0aGUgZXN0aW1hdG9yIGlzIHVuYmlhc2VkOgoKJCQKXGJlZ2lue2FycmF5fXtjY2N9CkVbXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19XSY9JkVbKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cbWF0aGJme1h9XlRcbWF0aGJme1l9XVxcIFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UIEVbXG1hdGhiZntZfV1cXFxcCiY9JiAoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX1cXFxcCiY9JiBcYm9sZHN5bWJvbHtcYmV0YX0KXGVuZHthcnJheX0KJCQKCgotLS0KCgojIyMgUHJvamVjdGlvbgoKVGhlcmUgaXMgYWxzbyBhbm90aGVyIHBpY3R1cmUgdG8gcmVncmVzc2lvbjoKCi0gSW5zdGVhZCBvZiBwbG90dGluZyBlYWNoIG9ic2VydmF0aW9uICRpPSAxIFxsZG90cyBuJCBhcyBhIGRhdGEtcG9pbnQgaW4gJFxtYXRoYmJ7Un1ecCQgd2l0aCBkaW1lbnNpb25zICQxIFxsZG90cyBwJCBmb3IgZXZlcnkgdmFyaWFibGUvZmVhdHVyZSB0aGF0IGlzIHJlY29yZGVkIGZvciBlYWNoIG9ic2VydmF0aW9uCgotIFdlIGNhbiBhbHNvIHBsb3QgJFxtYXRoYmZ7WX0kLCAkXGhhdHtcbWF0aGJme1l9fSQgYW5kIGVhY2ggY29sdW1uIG9mICRcbWF0aGJme1h9JDogJFxtYXRoYmZ7WH1faiQgd2l0aCAkaj0xIFxsZG90cyBwJCBhcyBhIHZlY3RvciBpbiAkXG1hdGhiYntSfV5uJCB3aXRoIGRpbWVuc2lvbnMgJDEgXGxkb3RzIG4kIGZvciBldmVyeSBvYnNlcnZhdGlvbi4KCi0gSW4gdGhpcyByZXByZXNlbnRhdGlvbiBsaW5lYXIgcmVncmVzc2lvbiBjYW4gYmUgaW50ZXJwcmV0ZWQgYXMgYSBwcm9qZWN0aW9uIG9mIHRoZSB2ZWN0b3IgJFxtYXRoYmZ7WX0kIG9udG8gdGhlIHN1YnNwYWNlIG9mICRcbWF0aGJie1J9Xm4kIHRoYXQgaXMgc3Bhbm5lZCBieSB0aGUgdmVjdG9ycyBmb3IgdGhlIHByZWRpY3RvcnMgJFxtYXRoYmZ7WH1fMSBcbGRvdHMgXG1hdGhiZntYfV9wJC4KCi0gVGhlIHNwYWNlICRcbWF0aGJme1h9XzEgXGxkb3RzIFxtYXRoYmZ7WH1fcCQgaXMgYWxzbyByZWZlcnJlZCB0byBhcyB0aGUgY29sdW1uIHNwYWNlIG9mICRcbWF0aGJme1h9JCwgdGhlIHNwYWNlIHRoYXQgY29uc2lzdHMgb2YgYWxsIGxpbmVhciBjb21iaW5hdGlvbnMgb2YgdGhlIHZlY3RvcnMgb2YgdGhlIHByZWRpY3RvcnMgb3IgY29sdW1ucyAkXG1hdGhiZntYfV8xIFxsZG90cyBcbWF0aGJme1h9X3AkLgoKCiMjIyMgSW50ZXJtZXp6bzogUHJvamVjdGlvbiBvZiB2ZWN0b3Igb24gWCAgYW5kIFkgYXhpcwoKJCQKXG1hdGhiZntlfT1cbGVmdFtcYmVnaW57YXJyYXl9e2N9IGVfMVxcZV8yXGVuZHthcnJheX1ccmlnaHRdLCBcbWF0aGJme3V9XzEgPSAgXGxlZnRbXGJlZ2lue2FycmF5fXtjfSAxXFwwXGVuZHthcnJheX1ccmlnaHRdLCBcbWF0aGJme3V9XzIgPSAgXGxlZnRbXGJlZ2lue2FycmF5fXtjfSAwXFwxXGVuZHthcnJheX1ccmlnaHRdCiQkCgoKYGBge3Igd2FybmluZz1GQUxTRSxtZXNzYWdlPUZBTFNFLGVjaG89RkFMU0V9CnBsb3RkYXRhIDwtIGRhdGEuZnJhbWUoZTE9MyxlMj0yKQpwbG90ZGF0YSAlPiUgZ2dwbG90KGFlcyh4PWUxLHk9ZTIpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX3NlZ21lbnQoYWVzKHggPSAzLCB5ID0gMiwgeGVuZCA9IDMsIHllbmQgPSAwKSxjb2xvcj0ib3JhbmdlIixsaW5ldHlwZT0yLHNpemU9MikgKwpnZW9tX3NlZ21lbnQoYWVzKHggPSAzLCB5ID0gMiwgeGVuZCA9IDAsIHllbmQgPSAyKSxjb2xvcj0ib3JhbmdlIixsaW5ldHlwZT0yLHNpemU9MikgKwogZ2VvbV9zZWdtZW50KGFlcyh4ID0gMCwgeSA9IDAsIHhlbmQgPSAzLCB5ZW5kID0gMiksCiAgICAgICAgICAgICAgICAgIGFycm93ID0gYXJyb3cobGVuZ3RoID0gdW5pdCgwLjUsICJjbSIpKSxjb2xvcj0icmVkIixzaXplPTIpICsKIGdlb21fc2VnbWVudChhZXMoeCA9IDAsIHkgPSAwLCB4ZW5kID0gMywgeWVuZCA9IDApLAogICAgICAgICAgICAgICAgICBhcnJvdyA9IGFycm93KGxlbmd0aCA9IHVuaXQoMC41LCAiY20iKSksY29sb3I9Im9yYW5nZSIsc2l6ZT0yKSArCiBnZW9tX3NlZ21lbnQoYWVzKHggPSAwLCB5ID0gMCwgeGVuZCA9IDAsIHllbmQgPSAyKSwKICAgICAgICAgICAgICAgICAgYXJyb3cgPSBhcnJvdyhsZW5ndGggPSB1bml0KDAuNSwgImNtIikpLGNvbG9yPSJvcmFuZ2UiLHNpemU9MikgICsKIGdlb21fc2VnbWVudChhZXMoeCA9IDAsIHkgPSAwLCB4ZW5kID0gMCwgeWVuZCA9IDEpLAogICAgICAgICAgICAgICAgICBhcnJvdyA9IGFycm93KGxlbmd0aCA9IHVuaXQoMC41LCAiY20iKSksc2l6ZT0yKSArCmdlb21fc2VnbWVudChhZXMoeCA9IDAsIHkgPSAwLCB4ZW5kID0gMSwgeWVuZCA9IDApLAogICAgICAgICAgICAgICAgICBhcnJvdyA9IGFycm93KGxlbmd0aCA9IHVuaXQoMC41LCAiY20iKSksc2l6ZT0yKSArCiBnZW9tX3RleHQoYWVzKHg9My4wNSx5PTIuMixsYWJlbD0iZT0oZTEsZTIpIiksY29sb3I9InJlZCIsc2l6ZSA9IDcsaGp1c3Q9ImxlZnQiKSArCiBnZW9tX3RleHQoYWVzKHg9My4wNSx5PTAsbGFiZWw9IihlMSwwKSIpLGNvbG9yPSJvcmFuZ2UiLHNpemUgPSA3LGhqdXN0PSJsZWZ0Iix2anVzdD0idG9wIikgKwogZ2VvbV90ZXh0KGFlcyh4PTAseT0yLjIsbGFiZWw9IigwLGUyKSIpLGNvbG9yPSJvcmFuZ2UiLHNpemUgPSA3LGhqdXN0PSJsZWZ0IikgKwogZ2VvbV90ZXh0KGFlcyh4PTAuMDUseT0xLjIsbGFiZWw9InUyPSgwLDEpIiksc2l6ZSA9IDcsaGp1c3Q9ImxlZnQiKSArCiAgIGdlb21fdGV4dChhZXMoeD0xLjA1LHk9MC4yLGxhYmVsPSJ1MT0oMSwwKSIpLHNpemUgPSA3LGhqdXN0PSJsZWZ0IikgICsKICAgY29vcmRfZml4ZWQoKSArCiAgeGxpbSgtLjUsNCkgKwogIHlsaW0oLS41LDIuNSkKYGBgCgoKCjEuIFByb2plY3Rpb24gb2YgdmVjdG9yIGUgb24geC1heGlzCgpcYmVnaW57ZXFuYXJyYXkqfQpcbWF0aGJme3V9XzFeVCBcbWF0aGJme2V9ICY9JiBcVmVydCBcbWF0aGJme3V9XzFcVmVydF8yICBcVmVydCBcbWF0aGJme2V9XzFcVmVydF8yIFxjb3MgPFxtYXRoYmZ7dX1fMSxcbWF0aGJme2V9XzE+XFwKJj0mXGxlZnRbXGJlZ2lue2FycmF5fXtjY30gMSYwXGVuZHthcnJheX1ccmlnaHRdIFxsZWZ0W1xiZWdpbnthcnJheX17Y30gZV8xXFxlXzJcZW5ke2FycmF5fVxyaWdodF1cXCAmPSYgMVx0aW1lcyBlXzEgKyAwIFx0aW1lcyBlXzIgXFwKJj0mIGVfMVxcClxlbmR7ZXFuYXJyYXkqfQoKMi4gUHJvamVjdGlvbiBvZiB2ZWN0b3IgZSBvbiB5LWF4aXMKClxiZWdpbntlcW5hcnJheSp9ClxtYXRoYmZ7dX1fMl5UIFxtYXRoYmZ7ZX0gJj0mIFxsZWZ0W1xiZWdpbnthcnJheX17Y2N9IDAmMVxlbmR7YXJyYXl9XHJpZ2h0XSBcbGVmdFtcYmVnaW57YXJyYXl9e2N9IGVfMVxcZV8yXGVuZHthcnJheX1ccmlnaHRdXFwgJj0mIDBcdGltZXMgZV8xICsgMSBcdGltZXMgZV8yIFxcCiY9JiBlXzIKXGVuZHtlcW5hcnJheSp9CgozLiBQcm9qZWN0aW9uIG9mIHZlY3RvciBlIG9uIGl0c2VsZgoKClxiZWdpbntlcW5hcnJheSp9ClxtYXRoYmZ7ZX1eVCBcbWF0aGJme2V9ICY9JlxsZWZ0W1xiZWdpbnthcnJheX17Y2N9IGVfMSZlXzJcZW5ke2FycmF5fVxyaWdodF0gXGxlZnRbXGJlZ2lue2FycmF5fXtjfSBlXzFcXGVfMlxlbmR7YXJyYXl9XHJpZ2h0XVxcCiY9JmVfMV4yK2VfMl4yXFwKJj0mXFZlcnQgZSBcVmVydF4yXzIgXHJpZ2h0YXJyb3cgXHRleHR7IFB5dGhhZ29yZWFuIHRoZW9yZW19ClxlbmR7ZXFuYXJyYXkqfQoKLS0tCgojIyMjIEludGVycHJldGF0aW9uIG9mIGxlYXN0IHNxdWFyZXMgYXMgYSBwcm9qZWN0aW9uCgpGaXR0ZWQgdmFsdWVzOgoKJCQKXGJlZ2lue2FycmF5fXtsY2x9ClxoYXR7XG1hdGhiZntZfX0gJj0mIFxtYXRoYmZ7WH1caGF0e1xib2xkc3ltYm9se1xiZXRhfX1cXAomPSYgXG1hdGhiZntYfSAoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7WX1cXAomPSYgXG1hdGhiZntIWX0KXGVuZHthcnJheX0KJCQKd2l0aCAkXG1hdGhiZntIfSQgdGhlIHByb2plY3Rpb24gbWF0cml4IGFsc28gcmVmZXJyZWQgdG8gYXMgdGhlIGhhdCBtYXRyaXguCgoKYGBge3J9ClggPC0gbW9kZWwubWF0cml4KH54LGRhdGEpClgKYGBgCgpgYGB7cn0KWHRYIDwtIHQoWCklKiVYClh0WApgYGAKCmBgYHtyfQpYdFhpbnYgPC0gc29sdmUodChYKSUqJVgpClh0WGludgpgYGAKCmBgYHtyfQpIIDwtIFggJSolIFh0WGludiAlKiUgdChYKQpICmBgYAoKCmBgYHtyfQpZIDwtIGRhdGEkeQpZaGF0IDwtIEglKiVZClloYXQKYGBgCgoKLSBXZSBjYW4gYWxzbyBpbnRlcnByZXQgdGhlIGZpdCBhcyB0aGUgcHJvamVjdGlvbiBvZiB0aGUgJG5cdGltZXMgMSQgdmVjdG9yICRcbWF0aGJme1l9JCBvbiB0aGUgY29sdW1uIHNwYWNlIG9mIHRoZSBtYXRyaXggJFxtYXRoYmZ7WH0kLgoKLSBTbyBlYWNoIGNvbHVtbiBpbiAkXG1hdGhiZntYfSQgaXMgYWxzbyBhbiAkblx0aW1lcyAxJCB2ZWN0b3IuCgotIEZvciB0aGUgdG95IGV4YW1wbGUgbj0zIGFuZCBwPTIuCiAgVGhlIG90aGVyIHBpY3R1cmUgdG8gbGluZWFyIHJlZ3Jlc3Npb24gaXMgdG8gY29uc2lkZXIgJFhfMCQsICRYXzEkIGFuZCAkWSQgYXMgdmVjdG9ycyBpbiB0aGUgc3BhY2Ugb2YgdGhlIGRhdGEgJFxtYXRoYmJ7Un1ebiQsIGhlcmUgJFxtYXRoYmJ7Un1eMyQgYmVjYXVzZSB3ZSBoYXZlIHRocmVlIGRhdGEgcG9pbnRzLgpTbyB0aGUgY29sdW1uIHNwYWNlIG9mIFggaXMgYSBwbGFuZSBpbiB0aGUgdGhyZWUgZGltZW5zaW9uYWwgc3BhY2UuCgpcWwpcaGF0e1xtYXRoYmZ7WX19ID0gXG1hdGhiZntYfSAoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfSBcbWF0aGJme1h9XlQgXG1hdGhiZntZfQpcXQoKMS4gUGxhbmUgc3Bhbm5lZCBieSBjb2x1bW4gc3BhY2U6ClRoZSBvdGhlciBwaWN0dXJlIHRvIGxpbmVhciByZWdyZXNzaW9uIGlzIHRvIGNvbnNpZGVyICRYXzAkLCAkWF8xJCBhbmQgJFkkIGFzIHZlY3RvcnMgaW4gdGhlIHNwYWNlIG9mIHRoZSBkYXRhICRcbWF0aGJie1J9Xm4kLCBoZXJlICRcbWF0aGJie1J9XjMkIGJlY2F1c2Ugd2UgaGF2ZSB0aHJlZSBkYXRhIHBvaW50cy4KCgpgYGB7cn0Kb3JpZ2luUm4gPC0gZGF0YS5mcmFtZShYMT0wLFgyPTAsWDM9MCkKZGF0YSR4MCA8LSAxCmRhdGFSbiA8LSBkYXRhLmZyYW1lKHQoZGF0YSkpCgpsaWJyYXJ5KHBsb3RseSkKCnAxIDwtIHBsb3RfbHkoCiAgICBvcmlnaW5SbiwKICAgIHggPSB+IFgxLAogICAgeSA9IH4gWDIsCiAgICB6PSB+IFgzLCBuYW1lPSJvcmlnaW4iKSAlPiUKICBhZGRfbWFya2Vycyh0eXBlPSJzY2F0dGVyM2QiKSAlPiUKICBsYXlvdXQoCiAgICBzY2VuZSA9IGxpc3QoCiAgICAgIGFzcGVjdG1vZGU9ImN1YmUiLAogICAgICB4YXhpcyA9IGxpc3QocmFuZ2U9YygtNCw0KSksIHlheGlzID0gbGlzdChyYW5nZT1jKC00LDQpKSwgemF4aXMgPSBsaXN0KHJhbmdlPWMoLTQsNCkpCiAgICAgICkKICAgICkKcDEgPC0gcDEgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCwxKSwKICAgIHkgPSBjKDAsMCksCiAgICB6ID0gYygwLDApLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImdyZXkiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIm9iczEiKSAlPiUKICBhZGRfdHJhY2UoCiAgICB4ID0gYygwLDApLAogICAgeSA9IGMoMCwxKSwKICAgIHogPSBjKDAsMCksCiAgICBtb2RlID0gImxpbmVzIiwKICAgIGxpbmUgPSBsaXN0KHdpZHRoID0gNSwgY29sb3IgPSAiZ3JleSIpLAogICAgdHlwZT0ic2NhdHRlcjNkIiwKICAgIG5hbWUgPSAib2JzMiIpICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKDAsMCksCiAgICB5ID0gYygwLDApLAogICAgeiA9IGMoMCwxKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJncmV5IiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZSA9ICJvYnMzIikgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCwxKSwKICAgIHkgPSBjKDAsMSksCiAgICB6ID0gYygwLDEpLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsYWNrIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZSA9ICJYMSIpICU+JQogICAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCwxKSwKICAgIHkgPSBjKDAsMiksCiAgICB6ID0gYygwLDMpLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsYWNrIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZSA9ICJYMiIpCnAxCmBgYAoKCjIuIFZlY3RvciBvZiBZOgoKQWN0dWFsIHZhbHVlcyBvZiAkXG1hdGhiZntZfSQ6CgpgYGB7cn0KZGF0YSR5CmBgYAoKXFsKXG1hdGhiZntZfT1cbGVmdFtcYmVnaW57YXJyYXl9e2N9CmByIGRhdGEkeVsxXWAgXFwKYHIgZGF0YSR5WzJdYCBcXApgciBkYXRhJHlbM11gClxlbmR7YXJyYXl9XHJpZ2h0XQpcXQoKYGBge3J9CnAyIDwtIHAxICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKDAsWVsxXSksCiAgICB5ID0gYygwLFlbMl0pLAogICAgeiA9IGMoMCxZWzNdKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlkiKQpwMgpgYGAKCjMuIFByb2plY3Rpb24gb2YgWSBvbnRvIGNvbHVtbiBzcGFjZQoKQWN0dWFsIHZhbHVlcyBvZiBmaXR0ZWQgdmFsdWVzICRcbWF0aGJme1xoYXR7WX19JDoKCmBgYHtyfQpkYXRhJHloYXQKYGBgCgpcWwpcbWF0aGJme1l9PVxsZWZ0W1xiZWdpbnthcnJheX17Y30KYHIgZGF0YSR5aGF0WzFdYCBcXApgciBkYXRhJHloYXRbMl1gIFxcCmByIGRhdGEkeWhhdFszXWAKXGVuZHthcnJheX1ccmlnaHRdClxdCgpgYGB7cn0KcDIgPC0gcDIgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxZaGF0WzFdKSwKICAgIHkgPSBjKDAsWWhhdFsyXSksCiAgICB6ID0gYygwLFloYXRbM10pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gIm9yYW5nZSIpLAogICAgdHlwZT0ic2NhdHRlcjNkIiwKICAgIG5hbWU9IlloYXQiKSAlPiUKICAgIGFkZF90cmFjZSgKICAgIHggPSBjKFlbMV0sWWhhdFsxXSksCiAgICB5ID0gYyhZWzJdLFloYXRbMl0pLAogICAgeiA9IGMoWVszXSxZaGF0WzNdKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiLCBkYXNoPSJkYXNoIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZT0iWSAtPiBZaGF0IgogICAgKQpwMgpgYGAKCiRcbWF0aGJme1l9JCBpcyBwcm9qZWN0ZWQgaW4gdGhlIGNvbHVtbiBzcGFjZSBvZiAkXG1hdGhiZntYfSQhIHNwYW5uZWQgYnkgdGhlIGNvbHVtbnMuCgojIyMjIEhvdyBkb2VzIHRoaXMgcHJvamVjdGlvbiB3b3Jrcz8KCiQkClxiZWdpbnthcnJheX17bGNsfQpcaGF0e1xtYXRoYmZ7WX19ICY9JiBcbWF0aGJme1h9IChcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXG1hdGhiZntZfVxcCiY9JiBcbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMS8yfShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTEvMn1cbWF0aGJme1h9XlRcbWF0aGJme1l9XFwKJj0mIFxtYXRoYmZ7U31cbWF0aGJme1N9XlRcbWF0aGJme1l9ClxlbmR7YXJyYXl9CiQkCgoKLSAkXG1hdGhiZntTfSQgaXMgYSBuZXcgb3J0aG9ub3JtYWwgYmFzaXMgaW4gJFxtYXRoYmJ7Un1eMiQsIGEgc3Vic3BhY2Ugb2YgJFxtYXRoYmJ7Un1eMyQKCi0gVGhlIHNwYWNlIHNwYW5uZWQgYnkgJFxtYXRoYmZ7U30kIGFuZCAkXG1hdGhiZntYfSQgaXMgdGhlIGNvbHVtbiBzcGFjZSBvZiAkXG1hdGhiZntYfSQsIGUuZy4gaXQgY29udGFpbnMgYWxsIHBvc3NpYmxlIGxpbmVhciBjb21iaW5hbnRpb25zIG9mICRcbWF0aGJme1h9JC4KJFxtYXRoYmZ7U31edFxtYXRoYmZ7WX0kIGlzIHRoZSBwcm9qZWN0aW9uIG9mICRcbWF0aGJme1l9JCBvbiB0aGlzIG5ldyBvcnRob25vcm1hbCBiYXNpcwoKYGBge3J9CnN2ZFggPC0gc3ZkKFgpICMgU1ZEIFggPSBVRFZeVApYdFhpbnZTcXJ0IDwtIHN2ZFgkdiAlKiVkaWFnKDEvc3ZkWCRkKSUqJXQoc3ZkWCR2KQpTIDwtIFggJSolIFh0WGludlNxcnQKYGBgCgoKLSAkXG1hdGhiZntTfSQgb3J0aG9ub3JtYWwgYmFzaXMKCmBgYHtyfQpTCnQoUyklKiVTCmBgYAoKLSAkXG1hdGhiZntTU31eVCQgZXF1YWxzIHByb2plY3Rpb24gbWF0cml4CgpgYGB7cn0KUyUqJXQoUykKSApgYGAKCgpgYGB7cn0KcDMgPC0gcDEgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxTWzEsMV0pLAogICAgeSA9IGMoMCxTWzIsMV0pLAogICAgeiA9IGMoMCxTWzMsMV0pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsdWUiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlMxIikgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxTWzEsMl0pLAogICAgeSA9IGMoMCxTWzIsMl0pLAogICAgeiA9IGMoMCxTWzMsMl0pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsdWUiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlMyIikKCnAzCmBgYAoKCi0gJFxtYXRoYmZ7U31eVFxtYXRoYmZ7WX0kIGlzIHRoZSBwcm9qZWN0aW9uIG9mICRcbWF0aGJme1l9JCBpbiB0aGUgc3BhY2Ugc3Bhbm5lZCBieSAkXG1hdGhiZntTfSQuCi0gSW5kZWVkICRcbWF0aGJme1N9XzFeVFxtYXRoYmZ7WX0kCgpgYGB7cn0KcDQgPC0gcDMgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxZWzFdKSwKICAgIHkgPSBjKDAsWVsyXSksCiAgICB6ID0gYygwLFlbM10pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gInJlZCIpLAogICAgdHlwZT0ic2NhdHRlcjNkIiwKICAgIG5hbWUgPSAiWSIpICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKDAsU1sxLDFdKihTWywxXSUqJVkpKSwKICAgIHkgPSBjKDAsU1syLDFdKihTWywxXSUqJVkpKSwKICAgIHogPSBjKDAsU1szLDFdKihTWywxXSUqJVkpKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiLGRhc2g9ImRhc2giKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lPSJZIC0+IFMxIikgJT4lIGFkZF90cmFjZSgKICAgIHggPSBjKFlbMV0sU1sxLDFdKihTWywxXSUqJVkpKSwKICAgIHkgPSBjKFlbMl0sU1syLDFdKihTWywxXSUqJVkpKSwKICAgIHogPSBjKFlbM10sU1szLDFdKihTWywxXSUqJVkpKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiLCBkYXNoPSJkYXNoIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZT0iWSAtPiBTMSIpCnA0CmBgYAoKLSBhbmQgJFxtYXRoYmZ7U31fMl5UXG1hdGhiZntZfSQKYGBge3J9CnA1IDwtIHA0ICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKDAsU1sxLDJdKihTWywyXSUqJVkpKSwKICAgIHkgPSBjKDAsU1syLDJdKihTWywyXSUqJVkpKSwKICAgIHogPSBjKDAsU1szLDJdKihTWywyXSUqJVkpKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiLGRhc2g9ImRhc2giKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lPSJZIC0+IFMyIikgJT4lIGFkZF90cmFjZSgKICAgIHggPSBjKFlbMV0sU1sxLDJdKihTWywyXSUqJVkpKSwKICAgIHkgPSBjKFlbMl0sU1syLDJdKihTWywyXSUqJVkpKSwKICAgIHogPSBjKFlbM10sU1szLDJdKihTWywyXSUqJVkpKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJyZWQiLCBkYXNoPSJkYXNoIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZT0iWSAtPiBTMiIpCnA1CmBgYAoKLSBZaGF0IGlzIHRoZSByZXN1bHRpbmcgdmVjdG9yIHRoYXQgbGllcyBpbiB0aGUgcGxhbmUgc3Bhbm5lZCBieSAkXG1hdGhiZntTfV8xJCBhbmQgJFxtYXRoYmZ7U31fMiQgYW5kIHRodXMgYWxzbyBpbiB0aGUgY29sdW1uIHNwYWNlIG9mICRcbWF0aGJme1h9JC4KCmBgYHtyfQpwNiA8LSBwNSAlPiUKICBhZGRfdHJhY2UoCiAgICB4ID0gYygwLFloYXRbMV0pLAogICAgeSA9IGMoMCxZaGF0WzJdKSwKICAgIHogPSBjKDAsWWhhdFszXSksCiAgICBtb2RlID0gImxpbmVzIiwKICAgIGxpbmUgPSBsaXN0KHdpZHRoID0gNSwgY29sb3IgPSAib3JhbmdlIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZSA9ICJZaGF0IikgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoWVsxXSxZaGF0WzFdKSwKICAgIHkgPSBjKFlbMl0sWWhhdFsyXSksCiAgICB6ID0gYyhZWzNdLFloYXRbM10pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gIm1hcm9vbjIiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gImUiKSAlPiUKICBhZGRfdHJhY2UoCiAgICB4ID0gYyhTWzEsMV0qKFNbLDFdJSolWSksWWhhdFsxXSksCiAgICB5ID0gYyhTWzIsMV0qKFNbLDFdJSolWSksWWhhdFsyXSksCiAgICB6ID0gYyhTWzMsMV0qKFNbLDFdJSolWSksWWhhdFszXSksCiAgICBtb2RlID0gImxpbmVzIiwKICAgIGxpbmUgPSBsaXN0KHdpZHRoID0gNSwgY29sb3IgPSAib3JhbmdlIiwgZGFzaD0iZGFzaCIpLAogICAgdHlwZT0ic2NhdHRlcjNkIiwKICAgIG5hbWUgPSAiWSAtPiBTIikgICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKFNbMSwyXSooU1ssMl0lKiVZKSxZaGF0WzFdKSwKICAgIHkgPSBjKFNbMiwyXSooU1ssMl0lKiVZKSxZaGF0WzJdKSwKICAgIHogPSBjKFNbMywyXSooU1ssMl0lKiVZKSxZaGF0WzNdKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJvcmFuZ2UiLCBkYXNoPSJkYXNoIiksCiAgICB0eXBlPSJzY2F0dGVyM2QiLAogICAgbmFtZSA9ICJZIC0+IFMiKQpwNgpgYGAKCiMjIyBFcnJvcgoKTm90ZSwgdGhhdCBpdCBpcyBhbHNvIGNsZWFyIGZyb20gdGhlIGVxdWF0aW9uIGluIHRoZSBkZXJpdmF0aW9uIG9mIHRoZSBsZWFzdCBzcXVhcmVzIHNvbHV0aW9uIHRoYXQgdGhlIHJlc2lkdWFsIGlzIG9ydGhvZ29uYWwgb24gdGhlIGNvbHVtbiBzcGFjZToKClxbCiAtMiBcbWF0aGJme1h9XlQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9KSA9IDAKXF0KCgojIyMgQ3Vyc2Ugb2YgZGltZW5zaW9uYWxpdHk/CgotIEltYWdpbmUgd2hhdCBoYXBwZW5zIHdoZW4gcCBhcHByb2FjaGVzIG4gJHA9biQgb3IgYmVjb21lcyBtdWNoIGxhcmdlciB0aGFuIHAgPj4gbiEhIQoKLSBTdXBwb3NlIHRoYXQgd2UgYWRkIGEgcHJlZGljdG9yICRcbWF0aGJme1h9XzIgPSBbMiwwLDFdXlQkPwoKJCQKXG1hdGhiZntZfT1cbGVmdFsKXGJlZ2lue2FycmF5fXtjfQoxXFwKMlxcCjJcXApcZW5ke2FycmF5fVxyaWdodF0sClxxdWFkClxtYXRoYmZ7WH09IFxsZWZ0WwpcYmVnaW57YXJyYXl9e2NjY30KMSYxJjJcXAoxJjImMFxcCjEmMyYxXFwKXGVuZHthcnJheX0KXHJpZ2h0XSwKXHF1YWQgXGJvbGRzeW1ib2x7XGJldGF9ID0gXGxlZnRbClxiZWdpbnthcnJheX17Y30KXGJldGFfMFxcClxiZXRhXzFcXApcYmV0YV8yClxlbmR7YXJyYXl9ClxyaWdodF0KXHF1YWQKXHRleHR7YW5kfQpccXVhZApcYm9sZHN5bWJvbHtcZXBzaWxvbn09ClxsZWZ0WwpcYmVnaW57YXJyYXl9e2N9ClxlcHNpbG9uXzFcXApcZXBzaWxvbl8yXFwKXGVwc2lsb25fMwpcZW5ke2FycmF5fQpccmlnaHRdCiQkCgoKYGBge3J9CmRhdGEkeDIgPC0gYygyLDAsMSkKZml0IDwtIGxtKHl+eCt4MixkYXRhKQojIHByZWRpY3QgdmFsdWVzIG9uIHJlZ3VsYXIgeHkgZ3JpZAp4MXByZWQgPC0gc2VxKC0xLCA0LCBsZW5ndGgub3V0ID0gMTApCngycHJlZCA8LSBzZXEoLTEsIDQsIGxlbmd0aC5vdXQgPSAxMCkKeHkgPC0gZXhwYW5kLmdyaWQoeCA9IHgxcHJlZCwKeDIgPSB4MnByZWQpCnlwcmVkIDwtIG1hdHJpeCAobnJvdyA9IDMwLCBuY29sID0gMzAsCmRhdGEgPSBwcmVkaWN0KGZpdCwgbmV3ZGF0YSA9IGRhdGEuZnJhbWUoeHkpKSkKCmxpYnJhcnkocGxvdDNEKQoKCiMgZml0dGVkIHBvaW50cyBmb3IgZHJvcGxpbmVzIHRvIHN1cmZhY2UKdGg9MjAKcGg9NQpzY2F0dGVyM0QoZGF0YSR4LAogIGRhdGEkeDIsCiAgWSwKICBwY2ggPSAxNiwKICBjb2w9ImRhcmtibHVlIiwKICBjZXggPSAxLAogIHRoZXRhID0gdGgsCiAgdGlja3R5cGUgPSAiZGV0YWlsZWQiLAogIHhsYWIgPSAieDEiLAogIHlsYWIgPSAieDIiLAogIHpsYWIgPSAieSIsCiAgY29sdmFyPUZBTFNFLAogIGJ0eSA9ICJnIiwKICB4bGltPWMoLTEsMyksCiAgeWxpbT1jKC0xLDMpLAogIHpsaW09YygtMiw0KSkKCgp6LnByZWQzRCA8LSBvdXRlcigKICB4MXByZWQsCiAgeDJwcmVkLAogIGZ1bmN0aW9uKHgxLHgyKQogIHsKICAgIGZpdCRjb2VmWzFdICsgZml0JGNvZWZbMl0qeDErZml0JGNvZWZbMl0qeDIKICB9KQoKeC5wcmVkM0QgPC0gb3V0ZXIoCiAgeDFwcmVkLAogIHgycHJlZCwKICBmdW5jdGlvbih4LHkpIHgpCgp5LnByZWQzRCA8LSBvdXRlcigKICB4MXByZWQsCiAgeDJwcmVkLAogIGZ1bmN0aW9uKHgseSkgeSkKCnNjYXR0ZXIzRChkYXRhJHgsCiAgZGF0YSR4MiwKICBkYXRhJHksCiAgcGNoID0gMTYsCiAgY29sPSJkYXJrYmx1ZSIsCiAgY2V4ID0gMSwKICB0aGV0YSA9IHRoLAogIHRpY2t0eXBlID0gImRldGFpbGVkIiwKICB4bGFiID0gIngxIiwKICB5bGFiID0gIngyIiwKICB6bGFiID0gInkiLAogIGNvbHZhcj1GQUxTRSwKICBidHkgPSAiZyIsCiAgeGxpbT1jKC0xLDQpLAogIHlsaW09YygtMSw0KSwKICB6bGltPWMoLTIsNCkpCgpzdXJmM0QoCiAgeC5wcmVkM0QsCiAgeS5wcmVkM0QsCiAgei5wcmVkM0QsCiAgY29sPSJibHVlIiwKICBmYWNldHM9TkEsCiAgYWRkPVRSVUUpCmBgYAoKTm90ZSwgdGhhdCB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gaXMgbm93IGEgcGxhbmUuCgpIb3dldmVyLCB3ZSBvYnRhaW4gYSBwZXJmZWN0IGZpdCBhbmQgYWxsIHRoZSBkYXRhIHBvaW50cyBhcmUgZmFsbGluZyBpbiB0aGUgcGxhbmUhIGByIHNldC5zZWVkKDQpOyBlbW9qaTo6ZW1vamkoImZlYXIiKWAKClRoaXMgaXMgb2J2aW91cyBpZiB3ZSBsb29rIGF0IHRoZSBjb2x1bW4gc3BhY2Ugb2YgWCEKCmBgYHtyfQpYIDwtIGNiaW5kKFgsYygyLDAsMSkpCnN2ZFggPC0gc3ZkKFgpICMgU1ZEIFggPSBVRFZeVApYdFhpbnZTcXJ0IDwtIHN2ZFgkdiAlKiVkaWFnKDEvc3ZkWCRkKSUqJXQoc3ZkWCR2KQpTIDwtIFggJSolIFh0WGludlNxcnQKCnA3IDwtIHAxICU+JQogIGFkZF90cmFjZSgKICAgIHggPSBjKDAsMiksCiAgICB5ID0gYygwLDApLAogICAgeiA9IGMoMCwxKSwKICAgIG1vZGUgPSAibGluZXMiLAogICAgbGluZSA9IGxpc3Qod2lkdGggPSA1LCBjb2xvciA9ICJkYXJrZ3JlZW4iKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlgzIikKcDcKYGBgCgpgYGB7cn0KcDggPC0gcDcgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxTWzEsMV0pLAogICAgeSA9IGMoMCxTWzIsMV0pLAogICAgeiA9IGMoMCxTWzMsMV0pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsdWUiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlMxIikgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxTWzEsMl0pLAogICAgeSA9IGMoMCxTWzIsMl0pLAogICAgeiA9IGMoMCxTWzMsMl0pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsdWUiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlMyIikgJT4lCiAgYWRkX3RyYWNlKAogICAgeCA9IGMoMCxTWzEsM10pLAogICAgeSA9IGMoMCxTWzIsM10pLAogICAgeiA9IGMoMCxTWzMsM10pLAogICAgbW9kZSA9ICJsaW5lcyIsCiAgICBsaW5lID0gbGlzdCh3aWR0aCA9IDUsIGNvbG9yID0gImJsdWUiKSwKICAgIHR5cGU9InNjYXR0ZXIzZCIsCiAgICBuYW1lID0gIlMzIikKCnA4CmBgYAoKLSBUaGUgY29sdW1uIHNwYWNlIG5vdyBzcGFucyB0aGUgZW50aXJlICAkXG1hdGhiYntSfV4zJCEKCi0gV2l0aCB0aGUgaW50ZXJjZXB0IGFuZCB0aGUgdHdvIHByZWRpY3RvcnMgd2UgY2FuIHRodXMgZml0IGV2ZXJ5IGRhdGFzZXQgdGhhdCBvbmx5IGhhcyAzIG9ic2VydmF0aW9ucyBmb3IgdGhlIHByZWRpY3RvcnMgYW5kIHRoZSByZXNwb25zZS4KCi0gU28gdGhlIG1vZGVsIGNhbiBubyBsb25nZXIgYmUgdXNlZCB0byBnZW5lcmFsaXNlIHRoZSBwYXR0ZXJucyBzZWVuIGluIHRoZSBkYXRhIHRvd2FyZHMgdGhlIHBvcHVsYXRpb24gKG5ldyBvYnNlcnZhdGlvbnMpLgoKLSBQcm9ibGVtIG9mIG92ZXJmaXR0aW5nISEhCgotIElmICRwID4+IG4kIHRoZW4gdGhlIHByb2JsZW0gZ2V0cyBldmVuIHdvcnNlISBUaGVuIHRoZXJlIGlzIGV2ZW4gbm8gbG9uZ2VyIGEgdW5pcXVlIHNvbHV0aW9uIHRvIHRoZSBsZWFzdCBzcXVhcmVzIHByb2JsZW0uLi4KCi0gSW5kZWVkLCB0aGVuIHdlIGhhdmUgbW9yZSB2ZWN0b3JzL2RpbWVuc2lvbnMvY29sdW1ucyBpbiBYICB0aGFuIGRhdGFwb2ludHMhCgoKIyMjIFZhcmlhbmNlIEVzdGltYXRvcj8KXFsKXGJlZ2lue2FycmF5fXtjY2x9ClxoYXR7XGJvbGRzeW1ib2x7XFNpZ21hfX1fe1xoYXR7XGJvbGRzeW1ib2x7XGJldGF9fX0KJj0mXHRleHR7dmFyfVxsZWZ0WyhcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXG1hdGhiZntZfVxyaWdodF1cXFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UXHRleHR7dmFyfVxsZWZ0W1xtYXRoYmZ7WX1ccmlnaHRdXG1hdGhiZntYfShcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9IFx0ZXh0eygqKX1cXFxcCiY9JihcbWF0aGJme1h9XlRcbWF0aGJme1h9KV57LTF9XG1hdGhiZntYfV5UKFxtYXRoYmZ7SX1cc2lnbWFeMilcbWF0aGJme1h9KFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX0KXFxcXAomPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7SX1ccXVhZFxtYXRoYmZ7WH0oXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxzaWdtYV4yXFxcXAolXGhhdHtcYm9sZG1hdGh7XFNpZ21hfX1fe1xoYXR7XGJvbGRzeW1ib2x7XGJldGF9fX0mPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVCBcdGV4dHt2YXJ9XGxlZnRbXG1hdGhiZntZfVxyaWdodF0oXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1cXAomPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0oXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxzaWdtYV4yXFxcXAomPSYoXG1hdGhiZntYfV5UXG1hdGhiZntYfSleey0xfVxzaWdtYV4yClxlbmR7YXJyYXl9ClxdCgooKikgVW5kZXIgYXNzdW1wdGlvbiB0aGF0IGFsbCBvYnNlcnZhdGlvbnMgJFxtYXRoYmZ7WX0kIGFyZSBpbmRlcGVuZGVudCBhbmQgaWRlbnRpY2FsbHkgZGlzdHJpYnV0ZWQuCgpUaGUgZmFjdCB0aGF0ICRcaGF0e1xib2xkc3ltYm9se1xiZXRhfX0kIGlzIHVuYmlhc2VkIGFuZCBoYXMgYSB2YXJpYW5jZSBvZiAkKFxtYXRoYmZ7WH1eVFxtYXRoYmZ7WH0pXnstMX1cc2lnbWFeMiQgd2lsbCBiZSBpbXBvcnRhbnQgd2hlbiBhc3Nlc3NpbmcgYXNzb2NpYXRpb24hCgojIyMgUHJvamVjdGluZyBjb3ZhcmlhdGVzIG91dCAKCldlIGNhbiBnZXQgcmlkIG9mIGNvdmFyaWF0ZXMgJFxtYXRoYmZ7WH1fYyQgYnkgcHJvamVjdGluZyB0aGVtIG91dCwgaS5lLiAKCiQkClxtYXRoYmZ7UH1fYyA9IChcbWF0aGJme0l9IC0gXG1hdGhiZntYfV94KFxtYXRoYmZ7WH1feF5UXG1hdGhiZntYfV94KV57LTF9XG1hdGhiZntYfV94XlQpCiQkCgpTbyBvbmUgb2J0YWlucyAKCiQkClxiZWdpbnthcnJheX17Y2NjY2NjY2NjfQpcbWF0aGJme1B9X2MgXG1hdGhiZnt5fSAmPSYgXG1hdGhiZntQfV9jIFxtYXRoYmZ7eH1fXHRleHR7dGVzdH1cYmV0YV9cdGV4dHt0ZXN0fSYgKyAmIFxtYXRoYmZ7UH1fYyBcbWF0aGJme1h9X2NcYm9sZHN5bWJvbHtcYmV0YX1fYyAmKyAmXG1hdGhiZntQfV9jIFxtYXRoYmZ7WnV9ICYrJlxtYXRoYmZ7UH1fYyBcYm9sZHN5bWJvbHtcZXBzaWxvbn0gXFwKXHRpbGRle1xtYXRoYmZ7eX19ICY9JiBcdGlsZGV7XG1hdGhiZnt4fX1fXHRleHR7dGVzdH1cYmV0YV9cdGV4dHt0ZXN0fSAmKyZcbWF0aGJmezB9JisgJlx0aWxkZXtcbWF0aGJme1p9fVxtYXRoYmZ7dX0gJismXHRpbGRle1xib2xkc3ltYm9se1xlcHNpbG9ufX0KXGVuZHthcnJheX0KJCQKCi0gJFxtYXRoYmZ7UH1feCQgcHJvamVjdHMgdmVjdG9ycyB0byBhbiAoTiDiiJIgQyktZGltZW5zaW9uYWwgc3Vic3BhY2Ugb3J0aG9nb25hbCBvbiB0aGUga25vd24gY292YXJpYXRlcy4gCi0ga2VlcCBpbiBtaW5kIHRoYXQgYWxsIHRoZXNlICROJCB2ZWN0b3JzIGFsbCBiZWxvbmcgdG8gdGhlIChOIOKIkiBDKS1kaW1lbnNpb25hbCBzdWJzcGFjZSEgICAKJFxyaWdodGFycm93JCBJbXBvcnRhbnQgd2hlbiBlc3RpbWF0aW5nICRcdGlsZGV7XG1hdGhiZnt5fX0kIGFuZCAgJFx0aWxkZXtcbWF0aGJme1p9fSQgCgojIyBCb2x0LUxNTSB1c2VzIGEgc2NvcmUgdGVzdCB0byB0ZXN0IGZvciB0aGUgY2FuZGlkYXRlIFNOUAoKSWYgYWxsIG1vZGVsIGFzc3VtcHRpb25zIGhvbGQgd2UgY2FuIGRlcml2ZSBhICRcY2hpXjIkIHRlc3QgdW5kZXIgdGhlIG51bGwgaHlwb3RoZXNpcyAkSF8wOiBcYm9sZHN5bWJvbHtcYmV0YX09XG1hdGhiZnswfSQ6IAoKJCQKdD1caGF0e1xiZXRhfVxoYXR7XGJvbGRzeW1ib2x7XFNpZ21hfX1fe1xoYXR7XGJldGF9fV57LTF9XGhhdHtcYmV0YX0KJCQKd2hpY2ggZm9sbG93cyBhbiBhc3ltcHRvdGljICRcY2hpXjIkIGRpc3RyaWJ1dGlvbiB1bmRlciAkSF8wJC4gCgpJbiBvdXIgY2FzZSB3ZSBvbmx5IHRlc3QgZm9yIG9uZSBtb2RlbCBwYXJhbWV0ZXIsIGkuZS4gdGhhdCBvZiB0aGUgY2FuZGlkYXRlIFNOUCBzbyB0aGUgdGVzdCByZWR1Y2VzIHRvIAoKJCQKdF97XGNoaV4yfT1cZnJhY3tcaGF0e1xiZXRhfV9cdGV4dHt0ZXN0fV4yfXtcdGV4dHtTRX1fe1xoYXR7XGJldGF9X1x0ZXh0e3Rlc3R9fV4yfSAKJCQKd2hpY2ggZm9sbG93cyBhbiBhc3ltcHRvdGljICRcY2hpXjJfMSQgZGlzdHJpYnV0aW9uIHdpdGggb25lIGRlZ3JlZSBvZiBmcmVlZG9tIHVuZGVyICRIXzAkLiAKCldlIG5lZWQgdGhlIGVzdGltYXRvciBmb3IgJFxoYXR7XGJldGF9JCBhbmQgJFxoYXR7XGJvbGRzeW1ib2x7XFNpZ21hfX0kLgoKIyMjIEludGVybWV6em8gZml0dGluZyBsaW5lYXIgbWl4ZWQgbW9kZWxzIChMTU0pCgpJbiB0aGUgZ2VuZXJhbCBmb3JtdWxhdGlvbiBvZiBMTU0gYWxzbyBhbGxvdyByYW5kb20gZWZmZWN0cyB0byBiZSBjb3JyZWxhdGVkLiAKCiQkClxsZWZ0XHsKXGJlZ2lue2FycmF5fXtjY2N9ClkgJj0mIFxtYXRoYmZ7WH1cYmV0YSArIFxtYXRoYmZ7WnV9ICsgXGJvbGRzeW1ib2x7XGVwc2lsb259XFwgClxtYXRoYmZ7dX0gJlxzaW0mXHRleHR7TVZOfShcbWF0aGJmezB9LFxtYXRoYmZ7R30pXFwKXGJvbGRzeW1ib2x7XGVwc2lsb259ICAmXHNpbSZcdGV4dHtNVk59KFxtYXRoYmZ7MH0sXG1hdGhiZntJfVxzaWdtYV4yX1xlcHNpbG9uKQpcZW5ke2FycmF5fQpccmlnaHQuCiQkCiAKVGhpcyBleHByZXNzaW9uIGltcGxpZXMgdGhyZWUgZGlmZmVyZW50IG1vZGVsIHJlcHJlc2VudGF0aW9uczogCgoxLiB0aGUgY29uZGl0aW9uYWwgbW9kZWwgKGNvbmRpdGlvbmFsIG9uIHRoZSByYW5kb20gZWZmZWN0cykKCiQkCmYoXG1hdGhiZntZfVx2ZXJ0IFxtYXRoYmZ7WCwgdX0pXHNpbSBcdGV4dHtNVk59KFxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX0rXG1hdGhiZntadX0sXG1hdGhiZntJfVxzaWdtYV4yX1xlcHNpbG9uKQokJAoKMi4gdGhlIGpvaW50IG1vZGVsIG9mICRcbWF0aGJme1l9JCBhbmQgJFxtYXRoYmZ7dX0kCiQkClxiZWdpbnthcnJheX17Y2NsfQpmKFxtYXRoYmZ7WSwgdX1cdmVydCBcbWF0aGJme1h9KSAmXHNpbSYgZihcbWF0aGJme1l9XHZlcnQgXG1hdGhiZntYLCB1fSkgZihcbWF0aGJme3V9KSBcXFxcCiZcc2ltJlx0ZXh0e01WTn0oXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfStcbWF0aGJme1p1fSxcbWF0aGJme0l9XHNpZ21hXjJfXGVwc2lsb24pXHRpbWVzXHRleHR7TVZOfShcbWF0aGJmezB9LFxtYXRoYmZ7R30pClxlbmR7YXJyYXl9CiQkCjMuIE1hcmdpbmFsIG1vZGVsIG9mICRcbWF0aGJme1l9JAoKJCQKXGJlZ2lue2FycmF5fXtyY2x9CmYoXG1hdGhiZntZfVx2ZXJ0IFxtYXRoYmZ7WH0pICZcc2ltJiBcaW50IGYoXG1hdGhiZntZLCB1fVx2ZXJ0IFxtYXRoYmZ7WH0pIGRcbWF0aGJme3V9IFxcXFwKJlxzaW0mIFx0ZXh0e01WTn0oXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfSxcbWF0aGJme1Z9KVxcXFwKXG1hdGhiZntWfSAmPSYgXG1hdGhiZntaR31cbWF0aGJme1p9XlQgKyBcbWF0aGJme0l9XHNpZ21hXjJfXGVwc2lsb24KXGVuZHthcnJheX0KJCQKU28gZXN0aW1hdGluZyB0aGUgbWl4ZWQgbW9kZWwgaW1wbGllcyBlc3RpbWF0aW5nCgotIE1vZGVsIHBhcmFtZXRlcnMgb2YgZml4ZWQgZWZmZWN0cyAkXGJvbGRzeW1ib2x7XGJldGF9JAotIFZhcmlhbmNlIGNvbXBvbmVudHMgJFxtYXRoYmZ7R30kIGFuZCAkXHNpZ21hXjJfXGVwc2lsb24kCgokXHJpZ2h0YXJyb3ckIFdlIGNhbiBkbyB0aGF0IGJ5IHVzaW5nIG1heGltdW0gbGlrZWxpaG9vZC4gCgotIENob29zaW5nIHRoZSBkYXRhIHBhcmFtZXRlcnMgYXMgc3VjaCBzbyB0aGF0IHRoZSBwcm9iYWJpbGl0eSB0byBvYnNlcnZlIHRoZSBkYXRhIHVuZGVyIHRoZSBtYXJnaW5hbCBtb2RlbCBiZWNvbWVzIG1heGltYWwgCgokJApMKFxib2xkc3ltYm9se1xiZXRhfSwgXG1hdGhiZntHfSxcc2lnbWFeMl9cZXBzaWxvbiBcdmVydCBcbWF0aGJme1gsIFl9KSA9IFxmcmFjezF9eygyXHBpKV57Ti8yfXxcbWF0aGJme1Z9fF57MS8yfX0gXGV4cFxsZWZ0KC1cZnJhY3sxfXsyfSAoXG1hdGhiZntZfSAtIFxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX0pXlQgXG1hdGhiZntWfV57LTF9IChcbWF0aGJme1l9IC0gXG1hdGhiZntYfVxib2xkc3ltYm9se1xiZXRhfSlccmlnaHQpCiQkClRoaXMgaXMgbmFzdHkgdG8gbWF4aW1pc2UgJFxyaWdodGFycm93JCBtYXhpbWlzZSB0aGUgbG9nLWxpa2VsaWhvb2QKCiQkCmwoXGJvbGRzeW1ib2x7XGJldGF9LCBcbWF0aGJme0d9LFxzaWdtYV4yX1xlcHNpbG9uIFx2ZXJ0IFxtYXRoYmZ7WCwgWX0pID0gLVxmcmFje059ezJ9IFxsb2coMlxwaSkgLSBcZnJhY3sxfXsyfSBcbG9nKHxcbWF0aGJme1Z9fCkgLSBcZnJhY3sxfXsyfSAgKFxtYXRoYmZ7WX0gLSBcbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9KV5UIFxtYXRoYmZ7Vn1eey0xfSAoXG1hdGhiZntZfSAtIFxtYXRoYmZ7WH1cYm9sZHN5bWJvbHtcYmV0YX0pCiQkCgokJApcYmVnaW57YXJyYXl9e3JjbH0KXGZyYWN7XHBhcnRpYWx9e1xwYXJ0aWFsIFxiZXRhfSBsKFxib2xkc3ltYm9se1xiZXRhfSwgXG1hdGhiZntHfSxcc2lnbWFeMl9cZXBzaWxvbiBcdmVydCBcbWF0aGJme1gsIFl9KSAmPSYgMCBcXFxcClxmcmFjezF9ezJ9IFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gKFxtYXRoYmZ7WX0gLSBcbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9KSAmPSYgMFxcXFwKXG1hdGhiZntYfV5UIFxtYXRoYmZ7Vn1eey0xfSBcbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9ICY9JlxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntZfVxcXFwKXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19ICY9JiAoXG1hdGhiZntYfV5UIFxtYXRoYmZ7Vn1eey0xfSBcbWF0aGJme1h9KV57LTF9IFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntZfQpcZW5ke2FycmF5fQokJApUaGUgdmFyaWFuY2UtY292YXJpYW5jZSBtYXRyaXggZm9yIHRoaXMgZXN0aW1hdG9yICBiZWNvbWVzOiAKCiQkClxiZWdpbnthcnJheX17cmNsfQpcdGV4dHt2YXJ9XGxlZnRbXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19XHJpZ2h0XSAmPSYgXHRleHR7dmFyfVxsZWZ0WyhcbWF0aGJme1h9XlQgXG1hdGhiZntWfV57LTF9IFxtYXRoYmZ7WH0pXnstMX0gXG1hdGhiZntYfV5UIFxtYXRoYmZ7Vn1eey0xfSBcbWF0aGJme1l9XHJpZ2h0XVxcXFwKXGJvbGRzeW1ib2x7XFNpZ21hfV9caGF0e1xib2xkc3ltYm9se1xiZXRhfX0gJj0mKFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntYfSleey0xfSBcbWF0aGJme1h9XlQgXG1hdGhiZntWfV57LTF9IFx0ZXh0e3Zhcn1cbGVmdFtcbWF0aGJme1l9XHJpZ2h0XSBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntYfSAoXG1hdGhiZntYfV5UIFxtYXRoYmZ7Vn1eey0xfSBcbWF0aGJme1h9KV57LTF9IFxcXFwKXGJvbGRzeW1ib2x7XFNpZ21hfV9caGF0e1xib2xkc3ltYm9se1xiZXRhfX0gJj0mKFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntYfSleey0xfSBcbWF0aGJme1h9XlQgXG1hdGhiZntWfV57LTF9IFxtYXRoYmZ7Vn0gXG1hdGhiZntWfV57LTF9IFxtYXRoYmZ7WH0gKFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntYfSleey0xfSBcXFxcClxib2xkc3ltYm9se1xTaWdtYX1fXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19ICY9JihcbWF0aGJme1h9XlQgXG1hdGhiZntWfV57LTF9IFxtYXRoYmZ7WH0pXnstMX0KXGVuZHthcnJheX0KJCQKU28gd2Ugb25seSBuZWVkIHRvIGVzdGltYXRlIHRoZSB2YXJpYW5jZSBjb21wb25lbnRzICRcbWF0aGJme0d9JCBhbmQgJFxzaWdtYV9cZXBzaWxvbl4yJC4gCgotIFRoaXMgY2FuIGJlIGRvbmUgYnkgdGhlIHByb2ZpbGUgbGlrZWxpaG9vZCwgaS5lLiByZXBsYWNpbmcgJFxib2xkc3ltYm9se1xiZXRhfSQgYnkgdGhlIE1MIGVzdGltYXRvciAkKFxtYXRoYmZ7WH1eVCBcbWF0aGJme1Z9XnstMX0gXG1hdGhiZntYfSleey0xfSBcbWF0aGJme1h9XlQgXG1hdGhiZntWfV57LTF9IFxtYXRoYmZ7WX0kLiAKLSBXZSAgdGhlbiBtYXhpbWlzZSB0aGUgcHJvZmlsZSBsaWtlbGlob29kIHRvICRcbWF0aGJme0d9JCBhbmQgJFxzaWdtYV9cZXBzaWxvbl4yJCAKLSBOb3RlIHRoYXQgdGhlIE1MIGZvciB0aGUgdmFyaWFuY2UgY29tcG9uZW50cyBhcmUgYmlhc2VkIGluIHNtYWxsIHNhbXBsZSBiZWNhdXNlIGl0IGRvZXMgbm90IGFjY291bnQgZm9yIHRoZSBsb3NzIGluIGRlZ3JlZXMgb2YgZnJlZWRvbSBkdWUgdG8gdGhlIGVzdGltYXRpb24gb2YgdGhlIGZpeGVkIGVmZmVjdCBtb2RlbCBwYXJhbWV0ZXJzCi0gVGhlcmVmb3JlLCBNTCBpcyBvZnRlbiByZXBsYWNlZCBieSByZXN0cmljdGVkIG1heGltdW0gbGlrZWxpaG9vZCAoUkVNTCkgd2hpY2ggYWRkcyBhIHBlbmFsdHkgdGVybSB0byB0aGUgTUwgdG8gY29ycmVjdCBmb3IgdGhlIGxvc3MgaW4gZGYuCgpPbmNlIGVzdGltYXRvcnMgZm9yIHRoZSB2YXJpYW5jZSBjb21wb25lbnRzICRcaGF0e1xtYXRoYmZ7R319JCBhbmQgJFxoYXR7XHNpZ21hfV9cZXBzaWxvbl4yJCBhcmUgb2J0YWluZWQgd2Ugd2lsbCBwbHVnIHRoZW0gaW4gJFxtYXRoYmZ7Vn0kLCAkXGhhdHtcbWF0aGJme1xiZXRhfX0kIGFuZCAkXGJvbGRzeW1ib2x7XFNpZ21hfV9caGF0e1xib2xkc3ltYm9se1xiZXRhfX0kCgoKCgokJApcYmVnaW57YXJyYXl9e2NjbH0KXGhhdHtcbWF0aGJme1Z9fSAmPSYgXG1hdGhiZntafVxoYXR7XG1hdGhiZntHfX1eey0xfVxtYXRoYmZ7Wn1eVCArIFxtYXRoYmZ7SX1caGF0XHNpZ21hXjJfXGVwc2lsb25cXFxcClxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fSAmPSYgKFxtYXRoYmZ7WH1eVCBcaGF0e1xtYXRoYmZ7Vn19XnstMX0gXG1hdGhiZntYfSleey0xfSBcbWF0aGJme1h9XlQgXGhhdHtcbWF0aGJme1Z9fV57LTF9IFxtYXRoYmZ7WX1cXFxcClxoYXR7XGJvbGRzeW1ib2x7XFNpZ21hfX1fXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19ICY9JihcbWF0aGJme1h9XlQgXGhhdHtcbWF0aGJme1Z9fV57LTF9IFxtYXRoYmZ7WH0pXnstMX0KXGVuZHthcnJheX0KJCQKCk5vdGUsIHRoYXQgCgotIGZvciBvdXIgR1dBUyBMTU0gJFxtYXRoYmZ7R30gPSBcbWF0aGJme0l9IFxzaWdtYV4yX3UkIGFuZCB0aHVzIHJlZHVjZXMgdG8gZXN0aW1hdGluZyAkXHNpZ21hXjJfdSQKLSBUaGUgb3B0aW1pc2F0aW9uIGZvciB0aGUgdmFyaWFuY2UgY29tcG9uZW50cyBpcyBjb21wdXRhdGlvbmFsbHkgZGVtYW5kaW5nIAotICRcaGF0e1xib2xkc3ltYm9se1xiZXRhfX0kIGFuZCAgJFxib2xkc3ltYm9se1xTaWdtYX1fXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19JCBpbnZvbHZlIHRoZSBjb21wdXRhdGlvbmFsbHkgY2hhbGxlbmdpbmcgY2FsY3VsYXRpb24gb2YgCiAgCiAgLSAkXGhhdHtcbWF0aGJme1Z9fV57LTF9JCBhbiAkTiBcdGltZXMgTiQgIHdpdGggJE4gPiA3MC4wMDAkIHN1YmplY3RzCiAgLSAkXG1hdGhiZntafV97R1JNfV5UXG1hdGhiZntafSQgYW4gJE0gXHRpbWVzIE0kIHdpdGggJE0gPiA1MDAuMDAwJCBoaWdoIHF1YWxpdHkgU05QcwogICAgCiMjIyBBZG9wdGluZyByZXN1bHQgdG8gQk9MVC1MTU0KCk5vdGUsIHRoYXQgaW4gQk9MVC1MTU0gdGhleSBwcm9maWxlZCBvdXQgYWxsIGZpeGVkIGVmZmVjdCBleGNlcHQgZm9yIHRoZSBjYW5kaWRhdGUgU05QLiAgICAKXHJpZ2h0YXJyb3cgc28gb25seSBvbmUgZml4ZWQgZWZmZWN0IHBhcmFtZXRlciAkXGhhdHtcYmV0YX1fXHRleHR7dGVzdH0kCgokJApcYmVnaW57YXJyYXl9e2NjbH0KXGhhdHtcYmV0YX1fXHRleHR7dGVzdH0gJj0mIChcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcaGF0e1xtYXRoYmZ7Vn19XnstMX1cdGlsZGV7XG1hdGhiZnt4fX1fXHRleHR7dGVzdH0pXnstMX1cdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcaGF0e1xtYXRoYmZ7Vn19XnstMX1cdGlsZGV7XG1hdGhiZnt5fX0gXFxcXAomPSYgXGZyYWN7KFx0aWxkZXtcbWF0aGJme3h9fV50X1x0ZXh0e3Rlc3R9IFxoYXR7XG1hdGhiZntWfX1eey0xfVx0aWxkZXtcbWF0aGJme3l9fSl9eyhcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcaGF0e1xtYXRoYmZ7Vn19XnstMX1cdGlsZGV7XG1hdGhiZnt4fX1fXHRleHR7dGVzdH0pfQpcZW5ke2FycmF5fQokJApOZXh0LCB3ZSBuZWVkIHRoZSAkXHRleHR7U0V9X3tcaGF0e1xiZXRhfV9cdGV4dHt0ZXN0fX0kCgokJApcdGV4dHtTRX1eMl97XGhhdHtcYmV0YX1fXHRleHR7dGVzdH19ID0gKFx0aWxkZXtcbWF0aGJme3h9fV50X1x0ZXh0e3Rlc3R9XGhhdHtcbWF0aGJme1Z9fV57LTF9XHRpbGRle1xtYXRoYmZ7eH19XnRfXHRleHR7dGVzdH0pXnstMX0KJCQKV2UgcGx1ZyAkXGhhdHtcYmV0YX1fXHRleHR7dGVzdH1eMiQgYW5kICRcdGV4dHtTRX1fe1xoYXR7XGJldGF9X1x0ZXh0e3Rlc3R9fV4yJCBpbiB0aGUgJFxjaGleMiQtdGVzdDoKCiQkIApcYmVnaW57YXJyYXl9e2NjbH0KdF97XGNoaV4yfSY9JlxmcmFje1xoYXR7XGJldGF9X1x0ZXh0e3Rlc3R9XjJ9e1x0ZXh0e1NFfV97XGhhdHtcYmV0YX1fXHRleHR7dGVzdH19XjJ9IFxcXFwKJj0mIFxmcmFjeyhcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcaGF0e1xtYXRoYmZ7Vn19XnstMX1cdGlsZGV7XG1hdGhiZnt5fX0pXjJ9eyhcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcaGF0e1xtYXRoYmZ7Vn19XnstMX1cdGlsZGV7XG1hdGhiZnt4fX1fXHRleHR7dGVzdH0pfQpcZW5ke2FycmF5fQokJCAKd2hpY2ggZm9sbG93cyBhICRcY2hpXjJfMSQgd2l0aCBvbmUgZGVncmVlIG9mIGZyZWVkb20uIAoKV2UgY2FuIGNvbnN0cnVjdCBhIHNjb3JlIHRlc3QgIGJ5IHJlcGxhY2luZyB0aGUgdmFyaWFuY2UgY29tcG9uZW50cyAkXHNpZ21hX1xlcHNpbG9uXjIkIGFuZCAkXHNpZ21hX3VeMiQgYnkgdGhlaXIgZXN0aW1hdGVzIHVuZGVyIHRoZSBtb2RlbCBpbXBsaWVkIGJ5ICRIXzA6IFxiZXRhX1x0ZXh0e3Rlc3R9ID0gMCQ6IAoKJCQgClx0aWxkZXtcbWF0aGJme3l9fSBcc2ltIFx0ZXh0e01WTn0oXG1hdGhiZnswfSxcbWF0aGJme1Z9KQokJAoKIyMjIExPQ08gc2NvcmUgdGVzdAoKV2l0aGluIGEgTGVhdmUgT25lIENocm9tb3NvbWUgT3V0IChMT0NPKSBzY2hlbWUsIHRoZSB0ZXN0IHN0YXRpc3RpYyBiZWNvbWVzCgokJCAKXHRhZ3s0fQp0X1x0ZXh0e0xPQ099ID0gXGZyYWN7KFx0aWxkZXtcbWF0aGJme3h9fV50X1x0ZXh0e3Rlc3R9IFxoYXR7Vn1eey0xfV97XHRleHR7TE9DT30sSF8wfVx0aWxkZXtcbWF0aGJme3l9fSleMn17XHRpbGRle1xtYXRoYmZ7eH19XnRfXHRleHR7dGVzdH0gXGhhdHtWfV57LTF9X3tcdGV4dHtMT0NPfSxIXzB9XHRpbGRle1xtYXRoYmZ7eH19X1x0ZXh0e3Rlc3R9fQokJAoKJFxyaWdodGFycm93JCBlZmZlY3Qgb2YgY2FuZGlkYXRlIFNOUCBub3QgYnkgZGlsdXRlZCBieSBwcm94aW1hbCBjb250YW1pbmF0aW9uLiAgICAKJFxyaWdodGFycm93JCB2YXJpYW5jZSBjb21wb25lbnRzIHVuZGVyICRIXzAkICAgICAKJFxyaWdodGFycm93JCAkXGhhdHtWfV57LTF9X3tcdGV4dHtMT0NPfSwgSF8wfSQgIGlzIHRoZSBzYW1lIGZvciBhbGwgY2FuZGlkYXRlIFNOUHMgZnJvbSB0aGUgc2FtZSBjaHJvbW9zb21lLiAKCiMjIEJPTFQtTE1NLWluZgoKIlRoZSBCT0xULUxNTS1pbmYgaW5maW5pdGVzaW1hbCBtaXhlZC1tb2RlbCBzdGF0aXN0aWMgaXMgc2xpZ2h0bHkgZGlmZmVyZW50IgoKIyMjIERlbm9taW5hdG9yIExPQ08gc3RhdGlzdGljIAoKVW5kZXIgdGhlIGFzc3VtcHRpb24gdGhhdCBtYW55IGxvY2kgd2l0aCBzbWFsbCBlZmZlY3RzIGNvbnRyb2wgdGhlIHRyYWl0LCB0aGUgZGVub21pbmF0b3Igb2YgdGhlIExPQ08gc2NvcmUgdGVzdCAgCgokJApcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSB7Vn1eey0xfV9cdGV4dHtMT0NPfVx0aWxkZXtcbWF0aGJme3h9fV50X1x0ZXh0e3Rlc3R9CiQkICAKCmlzICB2ZXJ5IHNpbWlsYXIgYmV0d2VlbiBhbGwgY2FuZGlkYXRlIFNOUHMgCgokXHJpZ2h0YXJyb3ckIGNhbiBiZSByZXBsYWNlZCBieSBhIGNhbGlicmF0aW9uIGZhY3RvciB0aGF0IG9ubHkgaGFzIHRvIGJlIGVzdGltYXRlZCBvbmNlISAKCgpUaGUgQk9MVC1MTU0taW5mIHN0YXRpc3RpY3MgdGh1cyBiZWNvbWVzOiAKCiQkdF9cdGV4dHtCT0xULUxNTS1pbmZ9ID0gXGZyYWN7KFx0aWxkZXtcbWF0aGJme3h9fV50X1x0ZXh0e3Rlc3R9IFxoYXR7Vn1eey0xfV97XHRleHR7TE9DT30sSF8wfVx0aWxkZXtcbWF0aGJme3l9fSleMn17Y19cdGV4dHtpbmZ9fSQkIAoKd2hpY2ggZm9sbG93cyBhICRcY2hpXjJfMSQgdW5kZXIgJEhfMCQuCgotIENhbGlicmF0aW9uIGZhY3RvciBlc3RpbWF0ZWQgd2l0aCAzMCByYW5kb20gU05QcyB3aXRob3V0IGVmZmVjdC4KCi0gSW1wb3J0YW50IHRvIGtlZXAgaW4gbWluZDogICAKCiQkIGNfXHRleHR7aW5mfSBcbGVmdHJpZ2h0YXJyb3cgXHRpbGRle1xtYXRoYmZ7eH19XlRcaGF0e1xtYXRoYmZ7Vn19XnstMX1fe1x0ZXh0e0xPQ099LEhfMH1cdGlsZGV7XG1hdGhiZnt4fX0kJAoKIyMgR2VuZXJhbGlzYXRpb24gb2YgQk9MVC1MTU0taW5mCgoiV2Ugbm93IGdlbmVyYWxpemUgQk9MVC1MTU0taW5mIGJ5IG9ic2VyaW5nIHRoYXQgdGhlIHZlY3RvciAkXG1hdGhiZntWfV57LTF9X3tcdGV4dHtMT0NPfSxIXzB9IFxtYXRoYmZ7eX0kIGFwcGVhcmluZyBpbiBlcXVhdGlvbiAoOCkgaXMgYSBzY2FsYXIgbXVsdGlwbGUgb2YgdGhlIHJlc2lkdWFsIHBoZW5vdHlwZSAkXHNpZ21hXjJfXGVwc2lsb24gXG1hdGhiZntWfV57LTF9X3tcdGV4dHtMT0NPfSxIXzB9IFxtYXRoYmZ7eX0kIGZyb20gdGhlIGJlc3QgbGluZWFyIHVuYmlhc2VkIHByZWRpY3Rpb24gKEJMVVApIgoKIyMjIFdoYXQgaXMgdGhlIGJlc3QgbGluZWFyIHVuYmlhc2VkIHByZWRpY3RvciBCTFVQPwoKCi0gVGhlIHJhbmRvbSBlZmZlY3RzIGNhbiBiZSBwcmVkaWN0ZWQgdXNpbmcgdGhlIEJMVVAKLSBBbiBlc3RpbWF0b3IgZm9yIHRoZSBmaXhlZCBlZmZlY3RzIGFuZCBmb3IgdGhlIHByZWRpY3Rpb24gb2YgdGhlIHJhbmRvbSBlZmZlY3RzIGNhbiBiZSBkZXJpdmVkIGZyb20gdGhlIGpvaW50LWxpa2VsaWhvb2Qgb2YgJFxtYXRoYmZ7WX0kIGFuZCAkXG1hdGhiZnt1fSQsIGkuZS4gCgoKTWF4aW1pc2luZyB0aGUgbG9nIG9mIHRoZSBqb2ludCBkZW5zaXR5ICRmKFxtYXRoYmZ7WX0sXG1hdGhiZnt1fVx2ZXJ0IFxtYXRoYmZ7WH0pJCB0byAkXG1hdGhiZnt1fSQgYW5kICRcYm9sZHN5bWJvbHtcYmV0YX0kOiAKCiQkClx0ZXh0e2FyZ21heH1fe1xtYXRoYmZ7dX0sXGJvbGRzeW1ib2x7XGJldGF9fSBcbGVmdFsKIC1cZnJhY3tOfXsyfVxsb2coIFxzaWdtYV4yX1xlcHNpbG9uKS1cZnJhY3sxfXsyXHNpZ21hXjJfXGVwc2lsb259XGxlZnQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9LVxtYXRoYmZ7WnV9XHJpZ2h0KV5UXGxlZnQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9LVxtYXRoYmZ7WnV9XHJpZ2h0KS0xLzJcbG9nKFx2ZXJ0XG1hdGhiZntHfVx2ZXJ0KS1cZnJhY3sxfXsyfVxtYXRoYmZ7dX1eVFxtYXRoYmZ7R31eey0xfVxtYXRoYmZ7dX1ccmlnaHRdCiQkCgpNYXhpbWlzYXRpb24gdG8gJFxib2xkc3ltYm9se1x0aGV0YX09XGxlZnRbXGJlZ2lue2FycmF5fXtjfSBcYm9sZHN5bWJvbHtcYmV0YX1cXFxtYXRoYmZ7dX1cZW5ke2FycmF5fVxyaWdodF0kIG9ubHkgaW52b2x2ZXMKCiQkCi1cZnJhY3sxfXsyXHNpZ21hXjJfXGVwc2lsb259XGxlZnQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9LVxtYXRoYmZ7WnV9XHJpZ2h0KV5UXGxlZnQoXG1hdGhiZntZfS1cbWF0aGJme1h9XGJvbGRzeW1ib2x7XGJldGF9LVxtYXRoYmZ7WnV9XHJpZ2h0KS1cZnJhY3sxfXsyfVxtYXRoYmZ7dX1eVFxtYXRoYmZ7R31eey0xfVxtYXRoYmZ7dX0KJCQKd2hpY2ggY2FuIGJlIHJld3JpdHRlbiBhcyBhIGtpbmQgb2YgbG9zcyBmdW5jdGlvbiB0aGF0IHdlIHdpbGwgbWluaW1pc2UKCiQkCkxee01NfT0oXG1hdGhiZntZfS1cbWF0aGJme0N9XGJvbGRzeW1ib2x7XHRoZXRhfSleVChcbWF0aGJme1l9LVxtYXRoYmZ7Q31cYm9sZHN5bWJvbHtcdGhldGF9KSt7XHNpZ21hXjJfXGVwc2lsb259XGJvbGRzeW1ib2x7XHRoZXRhfV5UXG1hdGhiZntIfVxib2xkc3ltYm9se1x0aGV0YX0KJCQKCndpdGggJFxtYXRoYmZ7Q309W1xtYXRoYmZ7WH1cdGV4dHsgfSBcbWF0aGJme1p9XSQgYW5kICRcbWF0aGJme0h9PVxsZWZ0W1xiZWdpbnthcnJheX17Y2N9ClxtYXRoYmZ7MH0mXG1hdGhiZnswfVxcClxtYXRoYmZ7MH0mXG1hdGhiZntHfV57LTF9ClxlbmR7YXJyYXl9ClxyaWdodF0kCgpXZSBjYW4gZmluZCB0aGUgZXN0aW1hdG9yIGZvciAkXGJvbGRzeW1ib2x7XHRoZXRhfSQgYnkgdGFrZW4gdGhlIGZpcnN0IGRlcml2YXRpdmUgb2YgJExee01NfSQgdG8gJFxib2xkc3ltYm9se1x0aGV0YX0kIGFuZCBzZXR0aW5nIGl0IHRvIHplcm8sIAokJApcYmVnaW57YXJyYXl9e3JjbH0KXGZyYWN7XHBhcnRpYWwgfXtccGFydGlhbCBcYm9sZHN5bWJvbHtcdGhldGF9fSBMXntNTX0gJj0mIDBcXFxcCi0yIFxtYXRoYmZ7Q31eVChcbWF0aGJme1l9LVxtYXRoYmZ7Q31cYm9sZHN5bWJvbHtcdGhldGF9KSsyIHtcc2lnbWFeMl9cZXBzaWxvbn0gSFxib2xkc3ltYm9se1x0aGV0YX0mPSYwXFxcXAotXG1hdGhiZntDfV5UXG1hdGhiZntZfStcbWF0aGJme0N9XlRcbWF0aGJme0N9XGJvbGRzeW1ib2x7XHRoZXRhfSsge1xzaWdtYV4yX1xlcHNpbG9ufSBIXGJvbGRzeW1ib2x7XHRoZXRhfSY9JjBcXFxcCiAoXG1hdGhiZntDfV5UXG1hdGhiZntDfSArIFxzaWdtYV4yX1xlcHNpbG9uIEgpXGJvbGRzeW1ib2x7XHRoZXRhfSAmPSZcbWF0aGJme0N9XlRcbWF0aGJme1l9XFxcXAogXGhhdHtcYm9sZHN5bWJvbHtcdGhldGF9fSAmPSYgIChcbWF0aGJme0N9XlRcbWF0aGJme0N9ICsgXHNpZ21hXjJfXGVwc2lsb24gSCleey0xfVxtYXRoYmZ7Q31eVFxtYXRoYmZ7WX0KXGVuZHthcnJheX0KJCQKCkZvciBvdXIgR1dBUyAtIExNTSB0aGlzIHJlZHVjZXMgdG8gCgokJApcbGVmdFtcYmVnaW57YXJyYXl9e2N9IFxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fVxcXGhhdHtcbWF0aGJme3V9fVxlbmR7YXJyYXl9XHJpZ2h0XSA9ICAKXGxlZnQoClxsZWZ0WwpcYmVnaW57YXJyYXl9e2NjfQpcbWF0aGJme1h9XlRcbWF0aGJme1h9JiBcbWF0aGJme1h9XlRcbWF0aGJme1p9XFwKXG1hdGhiZntafV5UXG1hdGhiZntYfSYgXG1hdGhiZntafV5UXG1hdGhiZntafQpcZW5ke2FycmF5fQpccmlnaHRdICsgClxmcmFje1xzaWdtYV4yX1xlcHNpbG9ufXtcc2lnbWFeMl91fSAKXGxlZnRbClxiZWdpbnthcnJheX17Y2N9ClxtYXRoYmZ7MH0mIFxtYXRoYmZ7MH1cXApcbWF0aGJmezB9JiBcbWF0aGJme0l9ClxlbmR7YXJyYXl9ClxyaWdodF0KXHJpZ2h0KV57LTF9ClxsZWZ0WwpcYmVnaW57YXJyYXl9e2N9ClxtYXRoYmZ7WH1eVFxcClxtYXRoYmZ7Wn1eVApcZW5ke2FycmF5fQpccmlnaHRdXG1hdGhiZntZfQokJAoKSXQgY2FuIGFsc28gYmUgc2hvd24gdGhhdCAkXGhhdHtcbWF0aGJme3V9fSQgZm9yIHRoZSBjb252ZW50aW9uYWwgTE1NIGVxdWFscyAKCiQkClxoYXR7XG1hdGhiZnt1fX09IFxoYXR7XG1hdGhiZntHfX1cbWF0aGJme1p9XlRcaGF0e1xtYXRoYmZ7Vn19XnviiJIgMX0gKFxtYXRoYmZ7WX0g4oiSIFxtYXRoYmZ7WH0gXGhhdHtcYm9sZHN5bWJvbHtcYmV0YX19KQokJCAKCmFuZCBmb3Igb3VyIEdXQVMtTE1NCgokJApcaGF0e1xtYXRoYmZ7dX19PSBcaGF0e1xzaWdtYX1eMl91XG1hdGhiZntafV5UXGhhdHtcbWF0aGJme1Z9fV574oiSIDF9IChcbWF0aGJme1l9IOKIkiBcbWF0aGJme1h9IFxoYXR7XGJvbGRzeW1ib2x7XGJldGF9fSkKJCQKCiMjIyBBZG9wdGluZyByZXN1bHQgdG8gdGhlIE5vbWluYXRvciBMT0NPIHN0YXRpc3RpYyBvZiB0aGUgQk9MVC1MTU0taW5mIHN0YXRpc3RpYwoKTW9yZW92ZXIsIHVuZGVyICRIXzA6IFxiZXRhX1x0ZXh0e3Rlc3R9PTAkIHRoZSBCTFVQIGZvciB0aGUgTE9DTyBTTlBzIGJlY29tZXMgIAoKJCQKXGhhdHtcbWF0aGJme3V9fV97XHRleHR7TE9DT30sIEhfMH0gPSBcaGF0XHNpZ21hXjJfe3UsXHRleHR7TE9DT30sSF8wfVxtYXRoYmZ7Wn1eVFxoYXR7XG1hdGhiZntWfX1ee+KIkiAxfV97XHRleHR7TE9DT30sIEhfMH0gXHRpbGRle1xtYXRoYmZ7eX19IAokJAokXHJpZ2h0YXJyb3ckIEJMVVAgcmVzaWR1YWxzIGJlY29tZSAKCiQkClxiZWdpbnthcnJheX17Y2NsfQpcbWF0aGJme3l9X1x0ZXh0e3Jlc2lkdWFsLUxPQ08sIEhfMH0gJj0mIFx0aWxkZXtcbWF0aGJme3l9fSAtIFxtYXRoYmZ7Wn1caGF0e1xtYXRoYmZ7dX19X3tcdGV4dHtMT0NPfSwgSF8wfVxcIFxcCiY9JiBcaGF0e1xtYXRoYmZ7Vn19X3tcdGV4dHtMT0NPfSwgSF8wfVxoYXR7XG1hdGhiZntWfX1fe1x0ZXh0e0xPQ099LCBIXzB9XnstMX1cdGlsZGV7XG1hdGhiZnt5fX0tXG1hdGhiZntafVxtYXRoYmZ7Wn1eVFxoYXRcc2lnbWFeMl97dSxcdGV4dHtMT0NPfSxIXzB9IFxoYXR7XG1hdGhiZntWfX1fe1x0ZXh0e0xPQ099LCBIXzB9XnstMX1cdGlsZGV7XG1hdGhiZnt5fX0gXFxcXAomPSYgKFxoYXR7XG1hdGhiZntWfX1fe1x0ZXh0e0xPQ099LCBIXzB9LVxtYXRoYmZ7Wn1cbWF0aGJme1p9XlRcaGF0XHNpZ21hXjJfe3UsXHRleHR7TE9DT30sSF8wfSkgXGhhdHtcbWF0aGJme1Z9fV97XHRleHR7TE9DT30sIEhfMH1eey0xfVx0aWxkZXtcbWF0aGJme3l9fSBcXFxcCiY9JiAoXG1hdGhiZntafV5UXG1hdGhiZntafVxoYXR7XHNpZ21hfV4yX3t1XHRleHR7TE9DT30sIEhfMH0rXG1hdGhiZntJfVxoYXR7XHNpZ21hfV4yXGVwc2lsb24tXG1hdGhiZntafVxtYXRoYmZ7Wn1eVFxoYXRcc2lnbWFeMl97dSxcdGV4dHtMT0NPfSxIXzB9KSBcaGF0e1xtYXRoYmZ7Vn19X3tcdGV4dHtMT0NPfSwgSF8wfV57LTF9XHRpbGRle1xtYXRoYmZ7eX19IFxcXFwKJj0mIFxoYXRcc2lnbWFeMl97XGVwc2lsb24sTE9DTyxIXzB9XGhhdHtcbWF0aGJme1Z9fV97XHRleHR7TE9DT30sIEhfMH1eey0xfVx0aWxkZXtcbWF0aGJme3l9fQpcZW5ke2FycmF5fQokJAokXHJpZ2h0YXJyb3ckIG5vbWluYXRvciBvZiBMT0NPIHNjb3JlIHRlc3QgdXBvbiBhIGZhY3RvciBlcXVhbCB0bzogCgokJAooXHRpbGRle1xtYXRoYmZ7eH19XnRfXHRleHR7dGVzdH0gXG1hdGhiZnt5fV9cdGV4dHtyZXNpZHVhbC1MT0NPLCBIXzB9KV4yCiQkCgpCT0xULUxNTS1pbmYgc3RhdGlzdGljIHRodXMgYmVjb21lczogCgokJHRfXHRleHR7Qk9MVC1MTU0taW5mfSA9IFxmcmFjeyhcdGlsZGV7XG1hdGhiZnt4fX1edF9cdGV4dHt0ZXN0fSBcbWF0aGJme3l9X1x0ZXh0e3Jlc2lkdWFsLUxPQ08sIEhfMH0pXjJ9e2N9JCQgCndpdGggYyB0aGUgYWRqdXN0ZWQgY2FsaWJyYXRpb24gZmFjdG9yLgoKIyMgQk9MVC1MTU0gR2F1c3NpYW4gbWl4dHVyZS1tb2RlbCBhc3NvY2lhdGlvbiB0ZXN0IAoKVG8gZ2VuZXJhbGlzZSB0aGUgZXN0aW1hdGlvbiB0byBub24taW5maW5pdGVzaW1hbCBnZW5ldGljIGFyY2hpdGV4dHVyZXMgdGhleSByZXBsYWNlIHRoZSBHYXVzc2lhbiBwcmlvciBvbiB0aGUgU05QIGVmZmVjdHMgc2l6ZXMgJHVfbSQgYnkgYSAKR2F1c3NpYW4gbWl4dHVyZSBwcmlvciA6IAoKJCR1X20gXHNpbSBwIE4oMCxcc2lnbWFeMl97dSwxfSkgKyAoMS1wKSBOKDAsXHNpZ21hXjJfe3UsMn0pJCQKCndpdGggYSBzbWFsbCBwcm9iYWJpbGl0eSAkcCA8PCAxJCBhbmQgJFxzaWdtYV4yX3t1LDF9ID4+IFxzaWdtYV4yX3t1LDJ9JC4KCi0gIlRoaXMgbWl4dHVyZSBtb3JlIGZsZXhpYmx5IG1vZGVscyB0aGUgaGVhdmllci10YWlsZWQgZGlzdHJpYnV0aW9ucyBvZiB0aGUgZ2VuZXRpYyBlZmZlY3RzIG9mIHR5cGljYWwgKG5vbi1pbmZpbml0ZXNpbWFsKSBwaGVub3R5cGVzLiIKCi0gIlRoZSBmaXJzdCBjb21wb25lbnQgaW4gdGhlIG1peHR1cmUgaXMgYSAnc2xhYicgdGhhdCBtb2RlbHMgdGhlIGV4aXN0ZW5jZSBvZiBhIHNtYWxsIG51bWJlciBvZiBsb2NpIHdpdGggcmVsYXRpdmVseSBsYXJnZSBlZmZlY3RzIGFuZCB0aGUgc2Vjb25kIGNvbXBvbmVudCBpcyBhIOKAmHNwaWtl4oCZIHRoYXQgbW9kZWxzIHRoZSBhc3N1bXB0aW9uIHRoYXQgbW9zdCBTTlBzIGhhdmUgYW4gZWZmZWN0IG9mIG5lYXJseeKAlGJ1dCBub3QgZXhhY3RseeKAlHplcm8gb24gdGhlIHBoZW5vdHlwZS4iCgotICIoTm90ZSwgaG93ZXZlciwgdGhhdCBhbGwgU05QcyBhcmUgYXNzaWduZWQgdGhlIHNhbWUgbWl4dHVyZSBwcmlvcjsgdGhhdCBpcywgU05QcyBhcmUgbm90IGluZGl2aWR1YWxseSBhbGxvY2F0ZWQgdG8gb25lIG9yIHRoZSBvdGhlciBjb21wb25lbnQuKSIKCi0gIkl0IGlzIGltcG9ydGFudCB0aGF0IHRoZSBzcGlrZSBjb21wb25lbnQgaGF2ZSBub256ZXJvIHZhcmlhbmNlIHNvIGFzIHRvIGNhcHR1cmUgZ2Vub21lLXdpZGUgZWZmZWN0cyBvbiBwaGVub3R5cGUgc3VjaCBhcyBhbmNlc3RyeSBvciByZWxhdGVkbmVzczsgdGhlbiwgd2hlbiB0ZXN0aW5nIFNOUHMgZm9yIGFzc29jaWF0aW9uLCB0aGVzZSBnZW5vbWUtd2lkZSBlZmZlY3RzIGFyZSBjb25kaXRpb25lZCBvdXQgZnJvbSByZXNpZHVhbCBwaGVub3R5cGVzLCBwcm90ZWN0aW5nIGFnYWluc3QgY29uZm91bmRpbmcuIgoKLSAiVW5kZXIgdGhpcyBnZW5lcmFsaXplZCBtb2RlbCwgcG9zdGVyaW9yIG1lYW5zIG5vIGxvbmdlciBjb3JyZXNwb25kIHRvIEJMVVAsIGJ1dCB3ZSBjYW4gc3RpbGwgYXBwcm94aW1hdGVseSBmaXQgdGhlIEJheWVzaWFuIG1vZGVsIChvbmNlIHBlciBsZWZ0LW91dCBjaHJvbW9zb21lKSBhbmQgb2J0YWluIHJlc2lkdWFscyIKCi0gIlBsdWdnaW5nIHRoZXNlIHJlc2lkdWFscyBpbnRvIGVxdWF0aW9uICgxMSkgZ2l2ZXMgdGhlIEJPTFQtTE1NIEdhdXNzaWFuIG1peHR1cmUtbW9kZWwgYXNzb2NpYXRpb24gdGVzdCBzdGF0aXN0aWMuIg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("boltLmm.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
